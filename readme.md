# vlang ä¸­æ–‡æ–‡æ¡£

ç¿»è¯‘è‡ªï¼š[vlang doc](https://github.com/vlang/v/blob/master/doc/docs.md)

# ä»‹ç»

V æ˜¯ä¸€é—¨é™æ€ç¼–è¯‘å‹è¯­è¨€ï¼Œè®¾è®¡ç”¨æ¥æ„å»ºå¯ç»´æŠ¤çš„è½¯ä»¶ ã€‚ä¸ Go ç›¸ä¼¼ï¼ŒåŒæ—¶è®¾è®¡æ—¶å‚è€ƒäº† Oberonï¼ŒRustï¼ŒSwiftï¼ŒKotlinï¼ŒPythonã€‚

V æ˜¯ä¸€é—¨ååˆ†ç®€å•çš„è¯­è¨€ï¼ŒèŠ±ç‚¹æ—¶é—´çœ‹å®Œæ•´ç¯‡æ–‡æ¡£ï¼Œä¹Ÿå°±åŸºæœ¬æŒæ¡äº† Vã€‚å¦‚æœç†Ÿæ‚‰ Goï¼Œé‚£å°±å·²ç»æŒæ¡äº† 80%ã€‚

V æ¨å´‡ä»¥æœ€å°çš„æŠ½è±¡æ¥å†™ç®€å•å¹²å‡€çš„ä»£ç ã€‚é™¤äº†ç®€å•å¤–ï¼ŒV ä¹Ÿèƒ½ç»™äºˆå¼€å‘è€…å¾ˆå¤§çš„èƒ½åŠ›ï¼Œæ‰€æœ‰èƒ½ç”¨å…¶å®ƒè¯­è¨€å®ç°çš„éƒ½èƒ½ç”¨ V å®ç°ã€‚

# å®‰è£…

æœ€ä¸»è¦çš„å®‰è£…æ–¹å¼æ˜¯ä»æºç å®‰è£…ï¼Œæ—¢ç®€å•åˆååˆ†å¿«ï¼ˆå‡ ç§’å³å¯ï¼‰ã€‚

## Linux, macOS, FreeBSD ç­‰

é¦–å…ˆéœ€è¦ gitï¼Œå’Œ C ç¼–è¯‘å™¨ï¼Œä¾‹å¦‚ï¼štccï¼Œgcc æˆ– clangï¼Œè¿˜æœ‰ makeï¼š

```shell
git clone https://github.com/vlang/v
cd v
make
# åˆ›å»ºé“¾æ¥
sudo ./v symlink
```

## Windows

é¦–å…ˆéœ€è¦ gitï¼Œå’Œ C ç¼–è¯‘å™¨ï¼Œä¾‹å¦‚ï¼štccï¼Œgcc æˆ– clangï¼Œè¿˜æœ‰ msvcï¼š

```shell
git clone https://github.com/vlang/v
cd v
make.bat -tcc
```

make.bat åé¢ä¹Ÿå¯ä»¥ä¼ é€’å…¶å®ƒå‚æ•°ï¼š-gccï¼Œ-msvcï¼Œ-clangï¼Œæ¥ä½¿ç”¨å…¶å®ƒ C ç¼–è¯‘å™¨ã€‚ä½† -tcc æ›´å°ï¼Œå®¹æ˜“å®‰è£…ï¼ˆ V ä¼šè‡ªåŠ¨ä¸‹è½½é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶ï¼‰ã€‚

æ¨èå°† v ç›®å½•æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·å¯ä»¥æ‰§è¡Œ `v.exe symlink`ã€‚

## Android

å¯ä»¥é€šè¿‡ vab å®‰è£… v å›¾å½¢åº”ç”¨åˆ° Android ä¸Šï¼Œ

V Android ä¾èµ–ï¼š**V**, **Java JDK** >= 8, Android **SDK + NDK**.

1. å®‰è£…ä¾èµ– (see [vab](https://github.com/vlang/vab))
2. è¿æ¥ä½ çš„å®‰å“è®¾å¤‡
3. è¿è¡Œ:

```shell
git clone https://github.com/vlang/vab && cd vab && v vab.v
./vab --device auto run /path/to/v/examples/sokol/particles
```

æ›´å¤šç»†èŠ‚ï¼š[vab GitHub repository](https://github.com/vlang/vab)ã€‚

# Hello World

```v
fn main() {
	println('hello world')
}
```

å°†ä¸Šè¿°ä»£ç ä¿å­˜åˆ° `hello.v`ï¼Œå†è¿è¡Œ `v run hello.v`ï¼š

```shell
v run hello.v
hello world
```

æ­å–œï¼ŒæˆåŠŸè¿è¡Œäº†ç¬¬ä¸€ä¸ª V ç¨‹åºã€‚

é€šè¿‡ `v hello.v` ç¼–è¯‘ `hello.v`ï¼Œç”Ÿæˆ hello çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç›´æ¥è¿è¡Œ `./hello`ã€‚æ›´å¤š v æŒ‡ä»¤è¯´æ˜å¯é€šè¿‡ `v help` æŸ¥çœ‹ã€‚

ä¸Šè¿°ä»£ç ä¸­ï¼Œé€šè¿‡ `fn` å£°æ˜äº†ä¸€ä¸ªåä¸º main çš„å‡½æ•°ï¼Œè¿”å›ç±»å‹å®šä¹‰åœ¨å‡½æ•°åä¹‹åï¼Œmain å‡½æ•°æ²¡æœ‰è¿”å›ä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥ main å‡½æ•°æ²¡æœ‰å®šä¹‰è¿”å›ç±»å‹ã€‚

å’Œå…¶å®ƒè¯­è¨€ï¼ˆä¾‹å¦‚ Cï¼ŒGo å’Œ Rustï¼‰ä¸€æ ·ï¼Œmain å‡½æ•°æ˜¯æ•´ä¸ªç¨‹åºçš„å…¥å£ã€‚

`println` æ˜¯å†…å»ºå‡½æ•°ï¼Œç”¨æ¥æ‰“å°å†…å®¹åˆ°æ ‡å‡†è¾“å‡ºä¸Šï¼Œä¸€èˆ¬å°±æ˜¯è¾“å‡ºåˆ°å‘½ä»¤è¡Œä¸Šã€‚

åœ¨å•æ–‡ä»¶çš„ç¨‹åºä¸­ï¼Œ`fn main()` å¯ä»¥è¢«çœç•¥ï¼Œåœ¨å†™ç±»ä¼¼è„šæœ¬çš„ä»£ç æˆ–å­¦ä¹ ä»£ç æ—¶ååˆ†ä¾¿åˆ©ã€‚å› æ­¤ï¼Œä¸ºäº†ç®€æ´ï¼Œä¸‹é¢æ•™ç¨‹ä¸­ä¼šçœç•¥ `fn main()`ã€‚

æ‰€ä»¥ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥çœç•¥æˆï¼š

```v
println('hello world')
```

ä¸€æ ·å¯ä»¥é€šè¿‡ v run è¿è¡Œã€‚

# è¿è¡Œå¤šä¸ªæ–‡ä»¶

åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­æœ‰å¤šä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ 1 ä¸ªåŒ…å« main å‡½æ•°ï¼Œå…¶å®ƒæ˜¯è¾…åŠ©å‡½æ•°ï¼Œæƒ³è¦å°†è¿™ä¸ªå‡ ä¸ªæ–‡ä»¶ç¼–è¯‘æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ `v run .`ï¼Œå¦‚æœå¸¦å‚æ•°ï¼š`v run . --yourparam some_other_stuff`ã€‚

ä¸Šè¿°å‘½ä»¤é¦–å…ˆä¼šç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œç„¶åå°†--yourparam some_other_stuff ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°ä¼ é€’åˆ°ç¨‹åºä¸­ã€‚

ç¨‹åºä¸­å¯ä»¥é€šè¿‡ä¸‹åˆ—æ–¹å¼ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°ï¼š

```v
import os

println(os.args)
```

æ³¨æ„å½“ç¨‹åºæ‰§è¡Œå®Œåï¼Œä¼šåˆ é™¤å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚æœéœ€è¦ä¿ç•™çš„è¯ï¼š

```shell
v -keepc run .
# æˆ–è€…æ‰‹åŠ¨ç¼–è¯‘
v .
```

æ³¨æ„ï¼šä»»ä½•ç¼–è¯‘å‚æ•°è¦æ”¾åœ¨ run ä¹‹å‰ï¼Œä»»ä½•ç¨‹åºæ‰§è¡Œå‚æ•°ï¼Œæ”¾åœ¨æºç ä¹‹åï¼Œå‚æ•°ä¼šåŸæ ·ä¼ é€’ç»™ç¨‹åºï¼Œv å‘½ä»¤ä¸ä¼šå¤„ç†ã€‚

# æ³¨é‡Š

```v
// è¿™æ˜¯å•è¡Œæ³¨é‡Š
/*
è¿™æ˜¯å¤šè¡Œæ³¨é‡Š
   /* å¯ä»¥å†…åµŒ */
*/
```

# å‡½æ•°

```v
fn main() {
	println(add(77, 33))
	println(sub(100, 50))
}

fn add(x int, y int) int {
	return x + y
}

fn sub(x int, y int) int {
	return x - y
}
```

å˜é‡ç±»å‹åœ¨å˜é‡åä¹‹åã€‚

ä¸ Go å’Œ C ä¸€æ ·ï¼Œå‡½æ•°ä¸èƒ½é‡è½½ï¼Œè¿™æ ·ç®€åŒ–èƒ½æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§ã€‚

å‡½æ•°å¯ä»¥åœ¨å£°æ˜å‰å°±ä½¿ç”¨ï¼Œä¾‹å¦‚ add å’Œ sub ä»£ç åœ¨ main ä¹‹åï¼Œä½†æ˜¯ main ä¸­å¯ä»¥è°ƒç”¨ã€‚è¿™é€‚ç”¨äº V ä¸­çš„æ‰€æœ‰å£°æ˜ï¼Œå¹¶ä¸”ä¸éœ€è¦å¤´æ–‡ä»¶æˆ–è€ƒè™‘æ–‡ä»¶å’Œå£°æ˜çš„é¡ºåºã€‚

## å¤šè¿”å›å€¼

```v
fn foo() (int, int) {
	return 2, 3
}

a, b := foo()
println(a) // 2
println(b) // 3
c, _ := foo() // å¿½ç•¥è¿”å›å€¼ä½¿ç”¨ `_`
```

# ç¬¦å·å¯è§æ€§

```v
pub fn public_function() {
}

fn private_function() {
}
```

å‡½æ•°é»˜è®¤æ˜¯ç§æœ‰çš„ä¸å¯¹å¤–æš´éœ²ï¼Œè¦ä½¿å¾—å…¶å®ƒæ¨¡å—å¯ä»¥ä½¿ç”¨ï¼Œéœ€è¦å‰ç½® `pub`ï¼Œå¯¹äºå¸¸é‡å’Œç±»å‹éƒ½ä¸€æ ·ã€‚

æ³¨æ„ï¼š`pub` åªèƒ½ç”¨äºè¢«å‘½åçš„æ¨¡å—ï¼Œå¦‚ä½•åˆ›å»ºæ¨¡å—å‚è§[æ¨¡å—](#æ¨¡å—)ã€‚

# å˜é‡

```v
name := 'Bob'
age := 20
large_number := i64(9999999999)
println(name)
println(age)
println(large_number)
```

ä½¿ç”¨ `:=` å£°æ˜å’Œåˆå§‹åŒ–å˜é‡ï¼Œè¿™ä¹Ÿæ˜¯ V ä¸­å”¯ä¸€çš„å£°æ˜æ–¹å¼ï¼Œè¿™ä¹Ÿè¯´æ˜å˜é‡éƒ½æœ‰åˆå§‹å€¼ã€‚

å˜é‡ç±»å‹å¯ä»¥ä»å³è¾¹å€¼ä¸­æ¨å¯¼å‡ºæ¥ï¼Œè½¬æ¢ç±»å‹çš„è¯ï¼Œé€šè¿‡ `T(v)` å°† v å€¼è½¬ä¸º T ç±»å‹ã€‚

ä¸åŒäºå…¶å®ƒè¯­è¨€ï¼ŒV åªèƒ½åœ¨å‡½æ•°ä¸­å£°æ˜å˜é‡ï¼Œå…¨å±€(æ¨¡å—)å˜é‡æ˜¯ä¸å­˜åœ¨çš„ï¼Œåœ¨ V ä¸­æ˜¯æ²¡æœ‰å…¨å±€çŠ¶æ€ï¼Œè¯¦ç»†è¯´æ˜å‚è§ï¼š[é»˜è®¤ä¸ºçº¯å‡½æ•°](#é»˜è®¤ä¸ºçº¯å‡½æ•°)ã€‚

ä¸ºä¿è¯ä»£ç é£æ ¼çš„ä¸€è‡´æ€§ï¼Œæ‰€æœ‰çš„å˜é‡å’Œå‡½æ•°åéƒ½ä½¿ç”¨ `snake_case` çš„æ ·å¼ï¼Œè€Œç±»å‹ååˆ™ä½¿ç”¨ `PascalCase` çš„æ ·å¼ã€‚

## å¯å˜å˜é‡

```v
mut age := 20
println(age)
age = 21
println(age)
```

æ”¹å˜å˜é‡çš„å€¼ä½¿ç”¨ `=`ï¼Œåœ¨ V ä¸­ï¼Œå˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ã€‚å¦‚æœè¦å¯æ”¹å˜ï¼Œåˆ™åœ¨å˜é‡å£°æ˜æ—¶åŠ  `mut`ã€‚

å¯ä»¥å°†ä¸Šé¢ä»£ç ä¸­ç¬¬ä¸€è¡Œçš„ mut å»é™¤ç¼–è¯‘è¯•è¯•ã€‚

## åˆå§‹åŒ– vs èµ‹å€¼

æ³¨æ„åŒºåˆ† `:=` å’Œ `=`ï¼Œ `:=` æ˜¯ç”¨æ¥å£°æ˜å’Œåˆå§‹åŒ–å˜é‡ï¼Œ `=` æ˜¯ç”¨æ¥èµ‹å€¼ã€‚

```v
fn main() {
	age = 21
}
```

è¿™ä¸ªä»£ç æ˜¯ç¼–è¯‘ä¸é€šè¿‡çš„ï¼Œage æ²¡æœ‰å£°æ˜ï¼Œæ‰€æœ‰å˜é‡åœ¨ V ä¸­éƒ½è¦è¢«å£°æ˜ã€‚

```v
fn main() {
	age := 21
}
```

å¤šä¸ªå˜é‡å€¼å¯ä»¥åœ¨ä¸€è¡Œä»£ç ä¸­æ”¹å˜ã€‚è¿™æ ·ï¼Œäº¤æ¢å˜é‡å€¼å¯ä»¥ä¸ç”¨ä¸­é—´å˜é‡æ¥å®ç°ã€‚

```v
mut a := 0
mut b := 1
println('$a, $b') // 0, 1
a, b = b, a
println('$a, $b') // 1, 0
```

## å˜é‡å£°æ˜çš„é”™è¯¯

åœ¨å¼€å‘æ¨¡å¼ä¸­ï¼Œæœªä½¿ç”¨çš„å˜é‡ç¼–è¯‘å™¨ä¼šå‘å‡ºè­¦å‘Šï¼Œ"unused variable"ã€‚åœ¨ç”Ÿäº§æ¨¡å¼ä¸­ï¼Œåˆ™å®Œå…¨ä¸ä¼šè¢«ç¼–è¯‘ã€‚ç”Ÿäº§æ¨¡å¼ä½¿ç”¨ï¼š`v -prod foo.v`ï¼Œç¼–è¯‘æ—¶è®¾ç½® `-prod`ã€‚

```v
fn main() {
	a := 10
	if true {
		a := 20 // error: redefinition of `a`
	}
	// warning: unused variable `a`
}
```

ä¸åŒä¸å…¶å®ƒè¯­è¨€ï¼Œå˜é‡é®è”½æ˜¯ä¸å…è®¸çš„ã€‚åœ¨å¤–éƒ¨ä»£ç å—ä¸­å·²ç»å£°æ˜äº†ä¸€ä¸ªå˜é‡ï¼Œåœ¨å…¶å†…éƒ¨ä»£ç å—ä¸­ï¼Œä¸èƒ½å†å£°æ˜åŒåçš„å˜é‡ï¼Œç¼–è¯‘ä¼šæŠ¥é”™ã€‚

ä½†æ˜¯å…è®¸é®è”½æ¨¡å—åï¼Œå› ä¸ºåœ¨æŸäº›æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼š

```v
import ui
import gg

fn draw(ctx &gg.Context) {
	gg := ctx.parent.get_ui().gg
	gg.draw_rect(10, 10, 100, 50)
}
```

# V ç±»å‹

## åŸå§‹ç±»å‹

```v
bool

string

i8    i16  int  i64
byte  u16  u32  u64

rune // Unicodeå­—ç¬¦

f32 f64

voidptr, size_t // ä¸»è¦å’Œ C äº¤äº’ä½¿ç”¨

any // ç±»ä¼¼äº C çš„ void* å’Œ Go çš„ interface{}
```

æ³¨æ„ä¸åŒäº C å’Œ Goï¼Œint éƒ½æ˜¯ 32 ä½æ•´å‹ã€‚

V ä¸­æ‰€æœ‰æ“ä½œè¦æ±‚ä¸¤è¾¹æ•°æ®ç±»å‹éƒ½è¦ä¸€è‡´ï¼Œå°çš„ç±»å‹å¯ä»¥è‡ªåŠ¨æå‡åˆ°ç¬¦åˆçš„å¤§çš„ç±»å‹ï¼Œè½¬åŒ–è§„åˆ™å¦‚ä¸‹ï¼š

```v
   i8 â†’ i16 â†’ int â†’ i64
                  â†˜     â†˜
                    f32 â†’ f64
                  â†—     â†—
 byte â†’ u16 â†’ u32 â†’ u64 â¬
      â†˜     â†˜     â†˜      ptr
   i8 â†’ i16 â†’ int â†’ i64 â¬
```

ä¾‹å¦‚ int å¯ä»¥è‡ªåŠ¨è½¬æ¢ä¸º i64 å’Œ f64ï¼Œä½†æ˜¯ä¸èƒ½ä¸º u32ï¼Œä¼šä¸¢å¤±ç¬¦å·ä½ã€‚int è½¬åŒ– f32 æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¤§æ•°å€¼çš„è¯ä¼šä¸¢å¤±ç²¾åº¦ã€‚

å­—é¢å€¼ 123 ä¼šé»˜è®¤ä¸º intï¼Œ4.56 ä¼šé»˜è®¤ä¸º f64ã€‚é™¤éæŒ‡å®šç±»å‹ï¼š

```v
u := u16(12)
v := 13 + u    // v is of type `u16` - ä¸å˜æ›´
x := f32(45.6)
y := x + 3.14  // x is of type `f32` - ä¸å˜æ›´
a := 75        // a is of type `int` - é»˜è®¤ int
b := 14.7      // b is of type `f64` - é»˜è®¤ float
c := u + a     // c is of type `int` - u ä¼šè‡ªåŠ¨è½¬æ¢ä¸º int
d := b + x     // d is of type `f64` - x ä¼šè‡ªåŠ¨è½¬æ¢ä¸º f64
```

## å­—ç¬¦ä¸²

```v
name := 'Bob'
println(name.len)
println(name[0]) // å­—ç¬¦ä¸²ç´¢å¼•ä¸º 0 çš„å­—èŠ‚ B
println(name[1..3]) // ç´¢å¼• 1 åˆ° 3 çš„å­å­—ç¬¦ä¸² 'ob'
windows_newline := '\r\n' // è½¬è¯‘å­—ç¬¦
assert windows_newline.len == 2
```

V ä¸­å­—ç¬¦ä¸²æ˜¯åªè¯»çš„å­—èŠ‚æ•°ç»„ï¼Œç”± UTF-8 ç¼–ç ï¼Œå…¶å€¼æ˜¯ä¸å¯å˜çš„ï¼Œä¸èƒ½æ”¹å˜å…¶ä¸­å€¼ï¼š

```v
mut s := 'hello ğŸŒ'
s[0] = `H` // ä¸å…è®¸
```

æ³¨æ„ç´¢å¼•å­—ç¬¦ä¸²ç”Ÿæˆçš„æ˜¯ `byte` ä¸æ˜¯ `rune`ã€‚

`rune` ç±»å‹è¦ä½¿ç”¨ ` :

```v
rocket := `ğŸš€`
assert 'aloha!'[0] == `a`
```

å•å¼•å·å’ŒåŒå¼•å·éƒ½å¯ä»¥ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚ ä¸ºä¿æŒä¸€è‡´æ€§ï¼Œé™¤éå­—ç¬¦ä¸²åŒ…å«å•å¼•å·ï¼Œå¦åˆ™ vfmt ä¼šå°†åŒå¼•å·è½¬æ¢ä¸ºå•å¼•å·ã€‚

åŸå§‹å­—ç¬¦ä¸²éœ€è¦å‰ç½® rï¼ŒåŸå§‹å­—ç¬¦ä¸²ä¸­å­—ç¬¦ä¸ä¼šè¢«è½¬è¯‘ï¼š

```v
s := r'hello\nworld'
println(s) // "hello\nworld"
```

å­—ç¬¦ä¸²å¯ä»¥å¾ˆç®€å•çš„è½¬æ¢æˆæ•°å­—ï¼š

```v
s := '42'
n := s.int() // 42
```

## Runes

`rune` è¡¨ç¤º unicode å­—ç¬¦ï¼Œæ˜¯ `u32` çš„åˆ«åã€‚ åˆ›å»ºæ–¹å¼ï¼š

```v
x := `ğŸš€`
```

å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡ `.runes()` æ–¹æ³•è½¬æ¢æˆ runesï¼š

```v
hello := 'Hello World ğŸ‘‹'
hello_runes := hello.runes() // [`H`, `e`, `l`, `l`, `o`, ` `, `W`, `o`, `r`, `l`, `d`, ` `, `ğŸ‘‹`]
```

## å­—ç¬¦ä¸²æ’å€¼

åœ¨å­—ç¬¦ä¸²ä¸­æ’å€¼ï¼Œåœ¨å˜é‡å‰ä½¿ç”¨ $ï¼Œå˜é‡ä¼šè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š

```v
name := 'Bob'
println('Hello, $name!') // Hello, Bob!
```

åŒæ ·é€‚ç”¨äºå­—æ®µï¼š`'age = $user.age'`ï¼Œæ›´å¤æ‚çš„è¡¨è¾¾å¼éœ€è¦ä½¿ç”¨ `${}`ï¼š`'can register = ${user.age > 13}'`ã€‚

æ ¼å¼åŒ–æ–¹å¼ç±»ä¼¼ C çš„ `printf()` åŒæ ·æ”¯æŒ `f`, `g`, `x` ç­‰æ ¼å¼åŒ–è¾“å‡ºå­—ç¬¦ä¸²ã€‚ç¼–è¯‘å™¨è´Ÿè´£å­˜å‚¨å¤§å°ï¼Œæ‰€ä»¥æ²¡æœ‰ `hd` or `llu`ã€‚

```v
x := 123.4567
println('x = ${x:4.2f}') // 123.46
println('[${x:10}]') // åœ¨å·¦ä¾§åŠ ç©ºæ ¼ => [   123.457]
println('[${int(x):-10}]') // åœ¨å³ä¾§åŠ ç©ºæ ¼ => [123       ]
println('[${int(x):010}]') // ç”¨ 0 å¡«å……ç©ºæ ¼ => [0000000123]
```

## å­—ç¬¦ä¸²æ“ä½œ

```v
name := 'Bob'
bobby := name + 'by' // + ç”¨æ¥ä¸²è”å­—ç¬¦ä¸²
println(bobby) // "Bobby"
mut s := 'hello '
s += 'world' // `+=` ç”¨æ¥è¿½åŠ å­—ç¬¦ä¸²
println(s) // "hello world"
```

ä¸èƒ½ç”¨ä¸€ä¸ªæ•´å‹åŠ åˆ°å­—ç¬¦ä¸²ä¸Šï¼š

```v
age := 10
println('age = ' + age) // error: infix expr: cannot use int (right expression) as string
```

è¦ä¹ˆå°†æ•´å‹è½¬æ¢æˆå­—ç¬¦ä¸²ï¼š

```v
age := 11
println('age = ' + age.str())
```

è¦ä¹ˆä½¿ç”¨å­—ç¬¦ä¸²æ’å€¼ï¼š

```v
age := 12
println('age = $age')
```

## æ•°å€¼

```v
a := 123
```

å°† 123 èµ‹å€¼ç»™ aï¼Œa é»˜è®¤æ˜¯ int ç±»å‹ã€‚

ä¹Ÿå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶ï¼ŒäºŒè¿›åˆ¶æˆ–å…«è¿›åˆ¶çš„æ ‡è®°æ³•èµ‹å€¼ï¼š

```v
a := 0x7B
b := 0b01111011
c := 0o173
```

æ‰€æœ‰å˜é‡çš„å€¼éƒ½æ˜¯ 123ï¼Œéƒ½æ˜¯ intï¼Œä¸ç®¡ç”¨ä»€ä¹ˆæ ‡è®°æ–¹å¼ã€‚

V ä¹Ÿæ”¯æŒç”¨ \_ åˆ†å‰²æ•°å­—ï¼š

```v
num := 1_000_000 // same as 1000000
three := 0b0_11 // same as 0b11
float_num := 3_122.55 // same as 3122.55
hexa := 0xF_F // same as 255
oct := 0o17_3 // same as 0o173
```

éœ€è¦è®¾ç½®ä¸åŒç±»å‹çš„æ•°å­—ï¼Œåˆ™æ˜ç¡®è®¾ç½®ç±»å‹ï¼š

```v
a := i64(123)
b := byte(42)
c := i16(12345)
```

æµ®ç‚¹æ•°çš„è®¾ç½®æ–¹å¼ç±»ä¼¼ï¼Œä¸æŒ‡å®šç±»å‹é»˜è®¤ä½¿ f64ï¼š

```v
f := 1.0
f1 := f64(3.14)
f2 := f32(3.14)
```

## æ•°ç»„

### åŸºæœ¬æ•°ç»„æ¦‚å¿µ

æ•°ç»„æ˜¯ä¸€ç³»åˆ—ç›¸åŒç±»å‹çš„å…ƒç´ çš„é›†åˆï¼Œæè¿°æ–¹å¼ä½¿ç”¨æ–¹æ‹¬å·åŒ…å«ä¸€ä¸²å…ƒç´ ã€‚å…¶ä¸­å…ƒç´ å¯ä»¥é€šè¿‡æ–¹æ‹¬å·å†…çš„ç´¢å¼•(ä» 0 å¼€å§‹)è®¿é—®ï¼š

```v
mut nums := [1, 2, 3]
println(nums) // `[1, 2, 3]`
println(nums[0]) // `1`
println(nums[1]) // `2`
nums[1] = 5
println(nums) // `[1, 5, 3]`
```

### æ•°ç»„å±æ€§

æœ‰ä¸¤ä¸ªå±æ€§æ§åˆ¶æ•°å­—çš„â€œé•¿åº¦â€ï¼š

- `len`ï¼šé•¿åº¦ - æ•°ç»„é¢„å…ˆåˆ†é…å’Œåˆå§‹åŒ–å…ƒç´ çš„æ•°é‡
- `cap`ï¼šå®¹é‡ - é¢„åˆ†é…çš„å†…å­˜ç©ºé—´å¤§å°ï¼Œä½†æ²¡æœ‰è¢«åˆå§‹åŒ–æˆ–è®¡ç®—ä½¿ç”¨ã€‚æ•°ç»„å¯ä»¥å¢é•¿åˆ°è¿™ä¸ªå¤§å°æ— éœ€é‡æ–°åˆ†é…ã€‚é€šå¸¸ V ä¼šè‡ªåŠ¨ç®¡ç†è¿™ä¸ªå±æ€§ï¼Œä½†æ˜¯ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨è®¾ç½®ã€‚

```v
mut nums := [1, 2, 3]
println(nums.len) // "3"
println(nums.cap) // "3" æˆ–æ›´å¤š
nums = [] // æ•°ç»„ç°åœ¨æ˜¯ç©ºçš„
println(nums.len) // "0"
```

æ³¨æ„ï¼Œæ•°ç»„çš„å±æ€§æ˜¯åªè¯»çš„ï¼Œç”¨æˆ·ä¸èƒ½ä¿®æ”¹ã€‚

### æ•°ç»„åˆå§‹åŒ–

åŸºæœ¬è¯­æ³•å¦‚ä¸Šæè¿°ï¼Œæ•°ç»„çš„ç±»å‹ç”±ç¬¬ä¸€ä¸ªå…ƒç´ å†³å®šï¼š

- `[1, 2, 3]` æ˜¯ä¸€ä¸ªæ•´å‹æ•°ç»„ (`[]int`)ã€‚
- `['a', 'b']` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ (`[]string`)ã€‚

ä¹Ÿå¯ä»¥æ˜ç¡®æŒ‡å®šç¬¬ä¸€ä¸ªå…ƒç´ çš„ç±»å‹ï¼š`[byte(16), 32, 64, 128]`ã€‚V çš„æ•°ç»„éƒ½æ˜¯åŒç±»å‹çš„ï¼Œæ‰€æœ‰å…ƒç´ ç±»å‹éƒ½ç›¸åŒï¼Œæ‰€ä»¥åƒ `[1, 'a']` è¿™æ ·çš„æ˜¯ç¼–è¯‘ä¸é€šè¿‡çš„ã€‚

å¯¹äºéå¸¸å¤§æˆ–è€…ç©ºæ•°ç»„æœ‰å¦ä¸€ç§åˆå§‹åŒ–æ–¹å¼ï¼š

```v
mut a := []int{len: 10000, cap: 30000, init: 3}
```

åˆ›å»ºäº†ä¸€ä¸ª 10000 ä¸ªå…ƒç´ çš„æ•´å‹æ•°ç»„ï¼Œå¹¶åˆå§‹åŒ–äº† 3 ä¸ªå…ƒç´ ã€‚å†…å­˜ä¸­åˆ†é…äº† 30000 ä¸ªå…ƒç´ å¤§å°çš„ç©ºé—´ã€‚å‚æ•° `len`ï¼Œ`cap` å’Œ `init`éƒ½æ˜¯å¯é€‰çš„ï¼›`len` é»˜è®¤æ˜¯ 0ï¼Œ`init` é»˜è®¤å€¼æ˜¯ç±»å‹çš„é»˜è®¤å€¼ï¼ˆæ•°å€¼æ˜¯ `0`ï¼Œå­—ç¬¦ä¸²æ˜¯ `''` ï¼‰ã€‚ç³»ç»Ÿè¿è¡Œæ—¶ä¼šç¡®ä¿ `cap` ä¸ä¼šå°äº `len`ï¼ˆå³ä½¿å£°æ˜è®¾ç½®çš„è¾ƒå°ï¼‰ï¼š

```v
arr := []int{len: 5, init: -1}
// `arr == [-1, -1, -1, -1, -1]`, arr.cap == 5

// å£°æ˜ä¸€ä¸ªç©ºæ•°ç»„
users := []int{}
```

è®¾ç½®å®¹é‡å¯ä»¥æé«˜æ€§èƒ½ï¼Œé¿å…æ·»åŠ å…ƒç´ æ—¶æ•°ç»„å†…å­˜çš„å†åˆ†é…ï¼š

```v
mut numbers := []int{cap: 1000}
println(numbers.len) // 0
// æ·»åŠ å…ƒç´ æ—¶ä¸ä¼šé‡æ–°åˆ†é…å†…å­˜
for i in 0 .. 1000 {
	numbers << i
}
```

æ³¨æ„ï¼šä¸Šè¿°ä»£ç ä¸­ä½¿ç”¨äº† [range for](#range for) çš„è¡¨è¾¾å¼å’Œ[ << æ“ä½œç¬¦](#æ•°ç»„æ“ä½œç¬¦)ã€‚

### æ•°ç»„ç±»å‹

ä¸€ä¸ªæ•°ç»„å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç±»å‹ï¼š

| Types        | Example Definition                   |
| ------------ | ------------------------------------ |
| Number       | `[]int,[]i64`                        |
| String       | `[]string`                           |
| Rune         | `[]rune`                             |
| Boolean      | `[]bool`                             |
| Array        | `[][]int`                            |
| Struct       | `[]MyStructName`                     |
| Channel      | `[]chan f64`                         |
| Function     | `[]MyFunctionType` `[]fn (int) bool` |
| Interface    | `[]MyInterfaceName`                  |
| Sum Type     | `[]MySumTypeName`                    |
| Generic Type | `[]T`                                |
| Map          | `[]map[string]f64`                   |
| Enum         | `[]MyEnumType`                       |
| Alias        | `[]MyAliasTypeName`                  |
| Thread       | `[]thread int`                       |
| Reference    | `[]&f64`                             |
| Shared       | `[]shared MyStructType`              |

ä¾‹ç¨‹ï¼š

è¿™ä¸ªä¾‹å­ä½¿ç”¨[ç»“æ„ä½“](#ç»“æ„ä½“)å’Œ[è”åˆç±»å‹](#è”åˆç±»å‹)æ¥åˆ›å»ºæ•°ç»„ã€‚

```v
struct Point {
	x int
	y int
}

struct Line {
	p1 Point
	p2 Point
}

type ObjectSumType = Line | Point

mut object_list := []ObjectSumType{}
object_list << Point{1, 1}
object_list << Line{
	p1: Point{3, 3}
	p2: Point{4, 4}
}
dump(object_list)
/*
object_list: [ObjectSumType(Point{
    x: 1
    y: 1
}), ObjectSumType(Line{
    p1: Point{
        x: 3
        y: 3
    }
    p2: Point{
        x: 4
        y: 4
    }
})]
*/
```

### å¤šç»´æ•°ç»„

äºŒç»´æ•°ç»„ï¼š

```v
mut a := [][]int{len: 2, init: []int{len: 3}}
a[0][1] = 2
println(a) // [[0, 2, 0], [0, 0, 0]]
```

ä¸‰ç»´æ•°ç»„ï¼š

```v
mut a := [][][]int{len: 2, init: [][]int{len: 3, init: []int{len: 2}}}
a[0][1][1] = 2
println(a) // [[[0, 0], [0, 2], [0, 0]], [[0, 0], [0, 0], [0, 0]]]
```

### æ•°ç»„æ“ä½œç¬¦

ä½¿ç”¨ `<<` æ¨é€æ“ä½œç¬¦å°†ä¸€ä¸ªå…ƒç´ æˆ–ä¸€ä¸ªæ•°ç»„åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„å°¾éƒ¨ã€‚

```v
mut nums := [1, 2, 3]
nums << 4
println(nums) // "[1, 2, 3, 4]"
// æ·»åŠ æ•°ç»„
nums << [5, 6, 7]
println(nums) // "[1, 2, 3, 4, 5, 6, 7]"
mut names := ['John']
names << 'Peter'
names << 'Sam'
// names << 10  <-- æ— æ³•ç¼–è¯‘ï¼Œnamesæ˜¯å­—ç¬¦ä¸²æ•°ç»„
```

ä½¿ç”¨ [in æ“ä½œç¬¦](#in æ“ä½œç¬¦) å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼š

```v
names := ['John', 'Peter', 'Sam']
println(names.len) // "3"
println('Alex' in names) // "false"
```

### æ•°ç»„æ–¹æ³•

æ‰€æœ‰æ•°ç»„å¯ä»¥ `println(arr)` æ‰“å°ï¼Œé€šè¿‡ `s := arr.str()` è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚

å¤åˆ¶æ•°ç»„ä½¿ç”¨ `.clone()`ï¼š

```v
nums := [1, 2, 3]
nums_copy := nums.clone()
```

ä½¿ç”¨ `.filter()` å’Œ`.map()` æ–¹æ³•å¯ä»¥é«˜æ•ˆçš„è¿‡æ»¤å’Œéå†æ•°ç»„ï¼š

```v
nums := [1, 2, 3, 4, 5, 6]
even := nums.filter(it % 2 == 0)
println(even) // [2, 4, 6]
// é€šè¿‡åŒ¿åå‡½æ•°è¿‡æ»¤
even_fn := nums.filter(fn (x int) bool {
	return x % 2 == 0
})
println(even_fn)
words := ['hello', 'world']
upper := words.map(it.to_upper())
println(upper) // ['HELLO', 'WORLD']
// é€šè¿‡åŒ¿åå‡½æ•°éå†
upper_fn := words.map(fn (w string) string {
	return w.to_upper()
})
println(upper_fn) // ['HELLO', 'WORLD']
```

`it` æ˜¯å†…å»ºå˜é‡æ¥æŒ‡ä»£å½“å‰è¿‡æ»¤æˆ–éå†è¿‡ç¨‹ä¸­çš„å…ƒç´ ã€‚

å¦å¤–ï¼Œè¿˜æä¾›äº†`.any()` å’Œ`.all()` æ–¹æ³•å¯ä»¥ä¾¿åˆ©çš„æµ‹è¯•å½“å‰å…ƒç´ æ˜¯å¦æ»¡è¶³ä¸€ä¸ªæ¡ä»¶ï¼š

```v
nums := [1, 2, 3]
println(nums.any(it == 2)) // true
println(nums.all(it >= 2)) // false
```

ä¸‹é¢æ˜¯æ•°ç»„å†…å»ºçš„æ–¹æ³•ï¼š

- `b := a.repeat(n)` å°† a æ•°ç»„çš„å…ƒç´ é‡å¤ n æ¬¡æ”¾å…¥ b æ•°ç»„
- `a.insert(i, val)` åœ¨ i ä½ç½®æ’å…¥ valï¼Œå¹¶å°†åç»­å…ƒç´ ä¾æ¬¡å¾€åç§»
- `a.insert(i, [3, 4, 5])` ä» i ä½ç½®å¼€å§‹æ’å…¥æ•°ç»„
- `a.prepend(val)` å°† val æ’å…¥åˆ°æ•°ç»„å¤´éƒ¨ï¼Œç­‰ä»·äº `a.insert(0, val)`
- `a.prepend(arr)` å°† arr æ•°ç»„æ’å…¥åˆ°æ•°ç»„å¤´éƒ¨
- `a.trim(new_len)` è£å‰ª new_len é•¿åº¦çš„æ•°ç»„ï¼Œåªæœ‰ new_len å°äºå½“å‰æ•°ç»„é•¿åº¦æ—¶æœ‰æ•ˆ
- `a.clear()`æ¸…ç©ºæ•°ç»„ï¼ˆä¸ä¼šæ”¹å˜ `cap`ï¼Œç­‰ä»·äº`a.trim(0)`ï¼‰
- `a.delete_many(start, size)` ä» start å¼€å§‹åˆ é™¤ size å¤§å°çš„è¿ç»­çš„æ•°ç»„ï¼Œä¼šè§¦å‘é‡æ–°åˆ†é…
- `a.delete(index)` åˆ é™¤ index å¤„çš„å…ƒç´ ï¼Œç­‰ä»·äº `a.delete_many(index, 1)`
- `v := a.first()` ç­‰ä»·äº `v := a[0]`
- `v := a.last()` ç­‰ä»·äº `v := a[a.len - 1]`
- `v := a.pop()` è·å–æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä»æ•°ç»„ä¸­ç§»é™¤
- `a.delete_last()` ç§»é™¤æœ€åä¸€ä¸ªå…ƒç´ 
- `b := a.reverse()` ç”Ÿæˆ a çš„ååºæ•°ç»„
- `a.reverse_in_place()` åœ¨ a ä¸­å°†å…ƒç´ çš„é¡ºåºè°ƒè½¬
- `a.join(joiner)` ä½¿ç”¨`joiner`å­—ç¬¦ä¸²ä½œä¸ºåˆ†éš”ç¬¦å°†å­—ç¬¦ä¸²æ•°ç»„è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²

### æ’åºæ•°ç»„

æ’åºæ•°ç»„çš„æ–¹å¼ååˆ†ç®€å•å’Œç›´è§‚ï¼Œç‰¹åˆ«å®šä¹‰äº† `a` å’Œ `b` æ¥æ”¯æŒè‡ªå®šä¹‰æ’åºæ¡ä»¶ã€‚

```v
mut numbers := [1, 3, 2]
numbers.sort() // 1, 2, 3
numbers.sort(a > b) // 3, 2, 1
```

```v
struct User {
	age  int
	name string
}

mut users := [User{21, 'Bob'}, User{20, 'Zarkon'}, User{25, 'Alice'}]
users.sort(a.age < b.age) // æ ¹æ® User.age æ¥æ’åº
users.sort(a.name > b.name) // æ ¹æ® User.name æ¥åå‘æ’åº
```

V æ”¯æŒè‡ªå®šä¹‰æ’åºï¼Œé€šè¿‡ `sort_with_compare` æ–¹æ³•å®ç°ï¼Œé€‚ç”¨äºéœ€è¦é€šè¿‡å¤šä¸ªå­—æ®µæ¥æ’åºçš„æƒ…å†µã€‚ä¸‹é¢çš„ä»£ç å°±é€šè¿‡ name æ¥æ­£å‘æ’åºï¼Œage æ¥åå‘æ’åºï¼š

```v
struct User {
	age  int
	name string
}

mut users := [User{21, 'Bob'}, User{65, 'Bob'}, User{25, 'Alice'}]

custom_sort_fn := fn (a &User, b &User) int {
	// return -1 å½“ a åœ¨ b ä¹‹å‰
	// return 0, ä¿æŒé¡ºåº
	// return 1 å½“ b åœ¨ a ä¹‹å‰
	if a.name == b.name {
		if a.age < b.age {
			return 1
		}
		if a.age > b.age {
			return -1
		}
		return 0
	}
	if a.name < b.name {
		return -1
	} else if a.name > b.name {
		return 1
	}
	return 0
}
users.sort_with_compare(custom_sort_fn)
```

### æ•°ç»„åˆ‡ç‰‡

åˆ‡ç‰‡æ˜¯ä¸€ä¸ªæ•°ç»„çš„éƒ¨åˆ†ï¼Œåˆå§‹åŒ–çš„æ–¹å¼æ˜¯åœ¨ç´¢å¼•å€¼ä¹‹é—´é€šè¿‡ `..` æ“ä½œç¬¦ç”Ÿæˆï¼Œå³ä¾§çš„ç´¢å¼•å€¼å¿…é¡»å¤§äºæˆ–ç­‰äºå·¦ä¾§å€¼ã€‚

å¦‚æœå³ä¾§å€¼çœç•¥ï¼Œåˆ™é»˜è®¤æ˜¯æ•°ç»„é•¿åº¦ï¼›å·¦ä¾§å€¼çœç•¥é»˜è®¤æ˜¯ 0ã€‚

```v
nums := [0, 10, 20, 30, 40]
println(nums[1..4]) // [10, 20, 30]
println(nums[..4]) // [0, 10, 20, 30]
println(nums[1..]) // [10, 20, 30, 40]
```

åœ¨ V ä¸­ï¼Œåˆ‡ç‰‡å°±æ˜¯æ•°ç»„æœ¬èº«ï¼Œå¹¶ä¸æ˜¯ä¸¤ä¸ªæˆªç„¶ä¸åŒçš„ç±»å‹ã€‚å› æ­¤ï¼Œæ•°ç»„çš„æ“ä½œåœ¨åˆ‡ç‰‡ä¸Šéƒ½èƒ½æ‰§è¡Œã€‚åˆ‡ç‰‡ä¹Ÿèƒ½è¿½åŠ åˆ°ç›¸åŒç±»å‹å…ƒç´ çš„æ•°ç»„ä¸Šï¼š

```v
array_1 := [3, 5, 4, 7, 6]
mut array_2 := [0, 1]
array_2 << array_1[..3]
println(array_2) // `[0, 1, 3, 5, 4]`
```

åˆ‡ç‰‡æ€»æ˜¯ä»¥æœ€å°çš„å®¹é‡ (`cap == len`) æ¥åˆ›å»ºï¼Œæ— è®ºæºæ•°ç»„çš„å®¹é‡å’Œé•¿åº¦æ˜¯å¤šå°‘ã€‚å½“å‘åˆ‡ç‰‡ä¸­å¢åŠ å…ƒç´ å¯¼è‡´åˆ‡ç‰‡å®¹é‡å˜åŒ–ï¼Œä¼šç«‹åˆ»é‡æ–°åˆ†é…å†…å­˜ï¼Œæ­¤æ—¶åˆ‡ç‰‡å°†ç‹¬ç«‹äºæºæ•°ç»„ï¼Œä¸ä¼šæ”¹å˜æºæ•°ç»„ï¼š

```v
mut a := [0, 1, 2, 3, 4, 5]
mut b := a[2..4]
b[0] = 7 // `b[0]` æ˜¯å¼•ç”¨è‡ª `a[2]`
println(a) // `[0, 1, 7, 3, 4, 5]`
b << 9
// `b` ä¼šé‡æ–°åˆ†é…å†…å­˜ï¼Œæ­¤æ—¶å°±ç‹¬ç«‹äº `a`
println(a) // `[0, 1, 7, 3, 4, 5]` - ä¸ä¼šæ”¹å˜
println(b) // `[7, 3, 9]`
```

å‘æºæ•°ç»„ä¸­æ·»åŠ å…ƒç´ ï¼Œå¦‚æœè¶…å‡ºå®¹é‡çš„è¯ï¼Œå†…å­˜ä¼šé‡æ–°åˆ†é…ï¼Œå¯¼è‡´æºæ•°ç»„ä¼šç‹¬ç«‹äºå­åˆ‡ç‰‡ï¼š

```v
mut a := []int{len: 5, cap: 6, init: 2}
mut b := a[1..4]
a << 3
// æ²¡æœ‰è¶…å‡º `cap` ä¸ä¼šé‡åˆ†é…
b[2] = 13 // `a[3]` æ˜¯è¢«ä¿®æ”¹çš„
a << 4
// a ä¼šè¢«é‡åˆ†é…æ­¤æ—¶ç‹¬ç«‹äº `b` (`cap` æ‰©å±•äº†)
b[1] = 3 // `a` ä¸­ä¸ä¼šå˜åŒ–
println(a) // `[2, 2, 2, 13, 2, 3, 4]`
println(b) // `[2, 3, 13]`
```

## å›ºå®šå¤§å°çš„æ•°ç»„

V ä¹ŸåŒæ ·æ”¯æŒå›ºå®šå¤§å°çš„æ•°ç»„ï¼Œä¸åŒäºå¸¸è§„æ•°ç»„ï¼Œå…¶é•¿åº¦æ—¶å›ºå®šçš„ï¼Œä¸èƒ½æ·»åŠ åˆ é™¤å…ƒç´ ï¼Œä½†æ˜¯å¯ä»¥ä¿®æ”¹å…ƒç´ ã€‚

å›ºå®šå¤§å°æ•°ç»„æ¯”å¸¸è§„æ•°ç»„æ›´åŠ é«˜æ•ˆï¼ŒèŠ‚çœå†…å­˜ã€‚å®ƒä»¬çš„æ•°æ®æ˜¯å­˜æ”¾åœ¨æ ˆä¸Šï¼Œæ‰€ä»¥å¯ä»¥å½“ç¼“å­˜ä¸€æ ·ä½¿ç”¨ï¼Œé¿å…åœ¨å †ä¸Šè¿›è¡Œé¢å¤–çš„å¼€é”€ã€‚

å¤§å¤šæ•°æ–¹æ³•åªé€‚ç”¨äºå¸¸è§„æ•°ç»„ï¼Œä¸é€‚ç”¨äºå›ºå®šå¤§å°æ•°ç»„ã€‚å¯ä»¥å°†å›ºå®šå¤§å°æ•°ç»„è½¬æ¢æˆæ•°ç»„åˆ‡é¢ä½¿ç”¨ã€‚

```v
mut fnums := [3]int{} // fnums æ˜¯å›ºå®šå¤§å° 3 çš„æ•°ç»„
fnums[0] = 1
fnums[1] = 10
fnums[2] = 100
println(fnums) // => [1, 10, 100]
println(typeof(fnums).name) // => [3]int

fnums2 := [1, 10, 100]! // å›ºå®šå¤§å°æ•°ç»„ç®€çŸ­çš„å£°æ˜æ–¹å¼ï¼ˆè¿™ä¸ªè¯­æ³•å¯èƒ½ä¼šæ”¹å˜ï¼‰

anums := fnums[0..fnums.len]
println(anums) // => [1, 10, 100]
println(typeof(anums).name) // => []int
```

æ³¨æ„ï¼Œåˆ‡ç‰‡çš„æ–¹å¼ä¼šå¯¼è‡´å¤åˆ¶å›ºå®šå¤§å°æ•°ç»„çš„æ•°æ®åˆ°ä¸€ä¸ªæ–°çš„å¸¸è§„æ•°ç»„ä¸­ã€‚

## Maps

```v
mut m := map[string]int{} // é”®æ˜¯ `string` å€¼æ˜¯ `int` çš„ map
m['one'] = 1
m['two'] = 2
println(m['one']) // "1"
println(m['bad_key']) // "0"
println('bad_key' in m) // `in` å¯ä»¥æ£€æµ‹æ˜¯å¦æœ‰è¿™ä¸ªé”®å­˜åœ¨
m.delete('two')
```

Maps çš„é”®ç±»å‹å¯ä»¥æ˜¯ string, rune, integer, float æˆ– voidptrã€‚

å¯ä»¥ä½¿ç”¨çŸ­å£°æ˜çš„è¯­æ³•å£°æ˜ mapï¼š

```v
numbers := map{
	'one': 1
	'two': 2
}
println(numbers)
```

å¦‚æœæ‰¾ä¸åˆ°é”®ï¼Œä¼šè¿”å›é›¶å€¼ï¼š

```v
sm := map{
	'abc': 'xyz'
}
val := sm['bad_key']
println(val) // ''

intm := map{
	1: 1234
	2: 5678
}
s := intm[3]
println(s) // 0
```

ä¹Ÿå¯ä»¥ä½¿ç”¨ `or {}` è¯­æ³•å¤„ç†æœªæ‰¾åˆ°é”®çš„æƒ…å†µï¼š

```v
mm := map[string]int{}
val := mm['bad_key'] or { panic('key not found') }
```

åŒæ ·ä¹Ÿèƒ½åœ¨æ•°ç»„ä¸­ä½¿ç”¨ `or {}`ï¼š

```v
arr := [1, 2, 3]
large_index := 999
val := arr[large_index] or { panic('out of bounds') }
```

# æ¨¡å—å¯¼å…¥

å…³äºåˆ›å»ºæ¨¡å—çš„ä¿¡æ¯å‚è§[æ¨¡å—](#æ¨¡å—)ã€‚

ä½¿ç”¨ `import` å…³é”®å­—å¯ä»¥å¯¼å…¥æ¨¡å—ï¼š

```v
import os

fn main() {
	// ä»å‘½ä»¤è¡Œä¸­è¯»å–
	name := os.input('Enter your name: ')
	println('Hello, $name!')
}
```

ä¸Šè¿°ä»£ç å¼•å…¥äº† os æ¨¡å—å°±å¯ä»¥ä½¿ç”¨å…¶å…¬å¼€çš„å£°æ˜å®šä¹‰ï¼Œå°±ä¾‹å¦‚ input å‡½æ•°ã€‚å…¶å®ƒå…¬å…±æ¨¡å—çš„å…¬å¼€å£°æ˜å‚è§ [æ ‡å‡†åº“](https://modules.vlang.io/index.html)ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ²¡äº‹è°ƒç”¨å¤–éƒ¨å‡½æ•°å¿…é¡»æ˜ç¡®æ¨¡å—åï¼Œèµ·åˆå¯èƒ½ä¼šæ˜¾å¾—å¾ˆå†—ä½™ï¼Œä½†æ˜¯è¿™æ ·è®©ä»£ç æ›´å®¹æ˜“é˜…è¯»å’Œç†è§£ï¼Œèƒ½æ¸…æ¥šçš„çŸ¥é“è¿™ä¸ªå‡½æ•°æ˜¯ä»å“ªä¸ªæ¨¡å—ä¸­è¢«è°ƒç”¨çš„ã€‚å¯¹äºå¤§å‹ç¨‹åºè€Œè¨€æ˜¯ååˆ†æœ‰ç”¨çš„ã€‚

å’Œ Go ä¸€æ ·ï¼Œä¸å…è®¸æ¨¡å—å¾ªç¯è°ƒç”¨ã€‚

## é€‰æ‹©æ€§å¯¼å…¥

å¯ä»¥é€‰æ‹©æ€§å¯¼å…¥ç‰¹å®šçš„å‡½æ•°ï¼Œç›´æ¥åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼š

```v
import os { input }

fn main() {
	// ä»å‘½ä»¤è¡Œä¸­è¯»å–
	name := input('Enter your name: ')
	println('Hello, $name!')
}
```

æ³¨æ„ï¼šè¿™è¿˜æ˜¯ä¼šå¯¼å…¥æ¨¡å—ï¼Œè€Œä¸”å¯¹äºå¸¸é‡è€Œè¨€æ˜¯ä¸å¯ä»¥è¿™æ ·ä½¿ç”¨ã€‚

å¯ä»¥ä¸€æ¬¡åŒæ—¶å¯¼å…¥å¤šä¸ªå‡½æ•°ï¼š

```v
import os { input, user_os }

name := input('Enter your name: ')
println('Name: $name')
os := user_os()
println('Your OS is ${os}.')
```

## æ¨¡å—å¯¼å…¥åˆ«å

ä»»ä½•å¯¼å…¥çš„æ¨¡å—å¯ä»¥ä½¿ç”¨ `as` å…³é”®å­—å£°æ˜åˆ«åï¼Œæ³¨æ„ä¸‹é¢ä»£ç æ— æ³•ç¼–è¯‘é€šè¿‡ï¼Œé™¤éåˆ›å»º `mymod/sha256.v`ï¼š

```v
import crypto.sha256
import mymod.sha256 as mysha256

fn main() {
	v_hash := sha256.sum('hi'.bytes()).hex()
	my_hash := mysha256.sum('hi'.bytes()).hex()
	assert my_hash == v_hash
}
```

ä¸èƒ½å¯¹å¯¼å…¥çš„å‡½æ•°å’Œç±»å‹å»ºåˆ«åï¼Œä½†æ˜¯å¯ä»¥é‡æ–°å£°æ˜ä¸€ä¸ªç±»å‹ã€‚

```v
import time
import math

type MyTime = time.Time

fn (mut t MyTime) century() int {
	return int(1.0 + math.trunc(f64(t.year) * 0.009999794661191))
}

fn main() {
	mut my_time := MyTime{
		year: 2020
		month: 12
		day: 25
	}
	println(time.new_time(my_time).utc_string())
	println('Century: $my_time.century()')
}
```

# æ¡ä»¶è¯­å¥å’Œè¡¨è¾¾å¼

## If

```v
a := 10
b := 20
if a < b {
	println('$a < $b')
} else if a > b {
	println('$a > $b')
} else {
	println('$a == $b')
}
```

if è¯­å¥å’Œå…¶å®ƒè¯­è¨€ç±»ä¼¼ï¼Œä½†æ˜¯ä¸åŒäºç±» C è¯­è¨€ï¼Œæ¡ä»¶éƒ¨åˆ†ä¸éœ€è¦å°æ‹¬å·ï¼Œè€Œå¤§æ‹¬å·æ˜¯å¿…é¡»è¦æœ‰çš„ã€‚

if è¯­å¥å¯ä»¥ç”¨åœ¨è¡¨è¾¾å¼ä¸­ï¼š

```v
num := 777
s := if num % 2 == 0 { 'even' } else { 'odd' }
println(s)
// "odd"
```

### ç±»å‹æ£€æŸ¥

ä½¿ç”¨ `is` å¯ä»¥æ£€æŸ¥å½“å‰ç±»å‹ï¼Œåä¹‹ç”¨ `!is`ã€‚å¯ä»¥ä½¿ç”¨åœ¨ if è¯­å¥ä¸­ï¼š

```v
struct Abc {
	val string
}

struct Xyz {
	foo string
}

type Alphabet = Abc | Xyz

x := Alphabet(Abc{'test'}) // sum type
if x is Abc {
	// x è‡ªåŠ¨è¢«è¯†åˆ«æˆ Abcï¼Œè¿›è¡Œä½¿ç”¨
	println(x)
}
if x !is Abc {
	println('Not Abc')
}
```

ä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨ match è¯­å¥ä¸­ï¼š

```v
match x {
	Abc {
		// x è‡ªåŠ¨è¢«è¯†åˆ«æˆ Abcï¼Œè¿›è¡Œä½¿ç”¨
		println(x)
	}
	Xyz {
		// x è‡ªåŠ¨è¢«è¯†åˆ«æˆ Xyzï¼Œè¿›è¡Œä½¿ç”¨
		println(x)
	}
}
```

å¯¹ç»“æ„ä½“ä¸­å­—æ®µä¹ŸåŒæ ·é€‚ç”¨ï¼š

```v
struct MyStruct {
	x int
}

struct MyStruct2 {
	y string
}

type MySumType = MyStruct | MyStruct2

struct Abc {
	bar MySumType
}

x := Abc{
	bar: MyStruct{123} // MyStruct ä¼šè‡ªåŠ¨è½¬æ¢æˆ MySumType
}
if x.bar is MyStruct {
	// x.bar è‡ªåŠ¨è¢«è¯†åˆ«
	println(x.bar)
}
match x.bar {
	MyStruct {
		// x.bar è‡ªåŠ¨è¢«è¯†åˆ«
		println(x.bar)
	}
	else {}
}
```

å¯¹äºå¯å˜å˜é‡è¿™ç§æ£€æŸ¥æ˜¯ä¸å®‰å…¨çš„ï¼Œç„¶è€Œï¼Œæœ‰æ—¶ä¹Ÿæ˜¯å¿…è¦çš„ã€‚æ‰€ä»¥ï¼Œéœ€è¦åœ¨è¡¨è¾¾å¼ä¸­åŠ å…¥ `mnt` å…³é”®å­—ï¼Œæ¥å‘Šè¯‰ç¼–è¯‘å™¨ã€‚åƒä¸‹é¢ä»£ç ï¼š

```v
mut x := MySumType(MyStruct{123})
if mut x is MyStruct {
	// x å³ä½¿æ˜¯å˜é‡ä¹Ÿä¼šè¢«è¯†åˆ«ä¸º MyStructï¼Œæ²¡æœ‰ mut å°±ä¸ä¼šæœ‰æ•ˆ
	println(x)
}
// same with match
match mut x {
	MyStruct {
		// x å³ä½¿æ˜¯å˜é‡ä¹Ÿä¼šè¢«è¯†åˆ«ä¸º MyStructï¼Œæ²¡æœ‰ mut å°±ä¸ä¼šæœ‰æ•ˆ
		println(x)
	}
}
```

## In æ“ä½œç¬¦

`in` å¯ä»¥ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦å†æ•°ç»„æˆ– map ä¸­ï¼Œåä¹‹ç”¨ `!in`ã€‚

```v
nums := [1, 2, 3]
println(1 in nums) // true
println(4 !in nums) // true
m := map{
	'one': 1
	'two': 2
}
println('one' in m) // true
println('three' !in m) // true
```

ä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨å¸ƒå°”è¡¨è¾¾å¼ä¸­ä½¿ä»£ç æ›´ç®€æ´å¹²å‡€ï¼š

```v
enum Token {
	plus
	minus
	div
	mult
}

struct Parser {
	token Token
}

parser := Parser{}
if parser.token == .plus || parser.token == .minus || parser.token == .div || parser.token == .mult {
	// ...
}
if parser.token in [.plus, .minus, .div, .mult] {
	// ...
}
```

V ä¼šä¼˜åŒ–ä¸Šé¢çš„è¡¨è¾¾å¼ï¼Œè¿™ä¸¤ç§æ–¹å¼éƒ½ä¼šç”Ÿæˆç›¸åŒçš„æœºå™¨ä»£ç ï¼Œä¸ä¼šæœ‰æ•°ç»„è¢«åˆ›å»ºã€‚

## For å¾ªç¯

V åªç”¨ä¸€ä¸ªå¾ªç¯å…³é”®å­— forï¼Œæœ‰ä¸åŒçš„ç”¨æ³•ã€‚

### for / in

æœ€å¸¸è§çš„å½¢å¼ï¼Œå¯ç”¨åœ¨æ•°ç»„ï¼Œmap å’Œæ•°å€¼èŒƒå›´ä¸­ã€‚

#### æ•°ç»„ for

```v
numbers := [1, 2, 3, 4, 5]
for num in numbers {
	println(num)
}
names := ['Sam', 'Peter']
for i, name in names {
	println('$i) $name')
	// Output: 0) Sam
	//         1) Peter
}
```

`for value in arr` çš„å½¢å¼å¯ä»¥éå†æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ ï¼Œå¦‚æœéœ€è¦ç´¢å¼•å€¼ï¼Œå¯ä»¥ä½¿ç”¨ `for index, value in arr`ã€‚

æ³¨æ„ï¼Œè¿™é‡Œçš„å€¼æ˜¯åªè¯»çš„ï¼Œå¦‚æœéœ€è¦åœ¨å¾ªç¯è¿‡ç¨‹ä¸­ä¿®æ”¹ï¼Œéœ€è¦å£°æ˜å¯å˜å˜é‡ï¼š

```v
mut numbers := [0, 1, 2]
for mut num in numbers {
	num++
}
println(numbers) // [1, 2, 3]
```

å½“æ ‡è¯†ç¬¦æ˜¯ `_` ä¸‹åˆ’çº¿ï¼Œåˆ™è¡¨ç¤ºè¿™ä¸ªå˜é‡æ˜¯å¿½ç•¥çš„ã€‚

#### è‡ªå®šä¹‰éå†å™¨

å®ç° `next` å‡½æ•°çš„ç±»å‹å¯ä»¥ç”¨åœ¨ for å¾ªç¯ä¸­ã€‚

```v
struct SquareIterator {
	arr []int
mut:
	idx int
}

fn (mut iter SquareIterator) next() ?int {
	if iter.idx >= iter.arr.len {
		return error('')
	}
	defer {
		iter.idx++
	}
	return iter.arr[iter.idx] * iter.arr[iter.idx]
}

nums := [1, 2, 3, 4, 5]
iter := SquareIterator{
	arr: nums
}
for squared in iter {
	println(squared)
}

/*
æ‰“å°ï¼š
1
4
9
16
25
*/
```

#### Map for

```v
m := map{
	'one': 1
	'two': 2
}
for key, value in m {
	println('$key -> $value')
	// Output: one -> 1
	//         two -> 2
}
```

é”®æˆ–å€¼éœ€è¦å¿½ç•¥çš„è¯ï¼Œä½¿ç”¨æ ‡è¯†ç¬¦ `_` ä¸‹åˆ’çº¿å³å¯ã€‚

```v
m := map{
	'one': 1
	'two': 2
}
// åªéå† keys
for key, _ in m {
	println(key)
	// Output: one
	//         two
}
// åªéå† values
for _, value in m {
	println(value)
	// Output: 1
	//         2
}
```

#### Range for

```v
// Prints '01234'
for i in 0 .. 5 {
	print(i)
}
```

`low .. high` è¡¨ç¤ºä» low å¼€å§‹åŒ…å« low åˆ° high ç»“æŸä½†ä¸åŒ…å« high çš„åŒºé—´ [lwo, high)ã€‚

### æ¡ä»¶ for å¾ªç¯

```v
mut sum := 0
mut i := 0
for i <= 100 {
	sum += i
	i++
}
println(sum) // "5050"
```

ç±»ä¼¼äºå…¶å®ƒè¯­è¨€çš„ whileï¼ŒçŸ¥é“æ¡ä»¶ä¸æ»¡è¶³æ—¶æ‰åœæ­¢ã€

### æ— æ¡ä»¶ for å¾ªç¯

```v
mut num := 0
for {
	num += 2
	if num >= 10 {
		break
	}
}
println(num) // "10"
```

æ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„æ— é™å¾ªç¯ã€‚

### C for

```v
for i := 0; i < 10; i += 2 {
	// ä¸æ‰“å° 6
	if i == 6 {
		continue
	}
	println(i)
}
```

æœ€ç»ˆæ˜¯å¤§å®¶å–œé—»ä¹è§çš„ C é£æ ¼ for å¾ªç¯ã€‚è¿™é‡Œçš„ i ä¸éœ€è¦ç”¨ mut ä¿®é¥°ï¼Œå› ä¸ºé»˜è®¤ä¼šå®šä¹‰æˆå¯å˜å€¼ã€‚

### å¸¦æ ‡ç­¾çš„ break å’Œ continue

`break` å’Œ`continue` é»˜è®¤åœ¨ for å¾ªç¯å†…éƒ¨è¿›è¡Œæ§åˆ¶ã€‚å¯ä»¥å¸¦ä¸Šæ ‡ç­¾è·³è½¬åˆ°å¤–å±‚å¾ªç¯ä¸­ã€‚

```v
outer: for i := 4; true; i++ {
	println(i)
	for {
		if i < 7 {
			continue outer
		} else {
			break outer
		}
	}
}
```

æ ‡ç­¾å¿…é¡»ç´§è·Ÿåœ¨å¤–éƒ¨å¾ªç¯å‰ï¼Œè¾“å‡ºç»“æœï¼š

```v
4
5
6
7
```

## Match

```v
os := 'windows'
print('V is running on ')
match os {
	'darwin' { println('macOS.') }
	'linux' { println('Linux.') }
	else { println(os) }
}
```

match è¯­æ³•æ˜¯ä¸€ä¸ªç®€å•å½¢å¼çš„ `if - else`ã€‚å½“ä¸€ä¸ªåˆ†æ”¯æ»¡è¶³æ—¶ï¼Œä¼šæ‰§è¡Œè¿™ä¸ªåˆ†æ”¯ä¸­çš„ä»£ç ï¼Œæ²¡æœ‰åˆ†æ”¯æ»¡è¶³æ—¶ï¼Œä¼šæ‰§è¡Œ else ä¸­çš„ä»£ç ã€‚

```v
number := 2
s := match number {
	1 { 'one' }
	2 { 'two' }
	else { 'many' }
}
```

match ä¹Ÿå¯ä»¥ç”¨åšè¡¨è¾¾å¼ï¼Œè¿”å›æœ€ç»ˆç¬¦åˆçš„åˆ†æ”¯ç»“æœã€‚

```v
enum Color {
	red
	blue
	green
}

fn is_red_or_blue(c Color) bool {
	return match c {
		.red, .blue { true } // å¯ç”¨æ¥åŒ¹é…å¤šå€¼
		.green { false }
	}
}
```

match å¯¹è±¡æ˜¯ enum æšä¸¾æ—¶å¯ä»¥ä½¿ç”¨ `.variant_here` çŸ­å¥è¯­æ³•ï¼Œå½“æ¯ä¸ªæšä¸¾å€¼åˆ—ä¸¾æ—¶ else æ˜¯ä¸èƒ½å­˜åœ¨çš„ã€‚

```v
c := `v`
typ := match c {
	`0`...`9` { 'digit' }
	`A`...`Z` { 'uppercase' }
	`a`...`z` { 'lowercase' }
	else { 'other' }
}
println(typ) // 'lowercase'
```

å¯ä»¥ä½¿ç”¨èŒƒå›´åŒ¹é…ï¼Œåœ¨è¿™ä¸ªèŒƒå›´å†…åˆ™æ‰§è¡Œåé¢ä»£ç ã€‚

æ³¨æ„è¿™é‡Œçš„èŒƒå›´æ˜¯ç”¨ `...` è€Œä¸æ˜¯ `..`ï¼Œå› ä¸ºè¿™ä¸ªèŒƒå›´æ˜¯åŒ…å«æœ€åä¸€ä¸ªå€¼çš„ï¼Œä½¿ç”¨ä¸‰ç‚¹åŒ…å«æœ€åä¸€ä¸ªå€¼ï¼Œä¸¤ç‚¹ä¸åŒ…å«æœ€åä¸€ä¸ªå€¼ï¼Œåœ¨ match ä½¿ç”¨ä¸¤ç‚¹ä¼šæŠ›å‡ºé”™è¯¯ã€‚

## Defer

defer åŒ…å«çš„ä»£ç å—åªæœ‰åœ¨å¤–å±‚ä»£ç å—æ‰§è¡Œç»“æŸè¿”å›æ—¶æ‰æ‰§è¡Œã€‚

```v
import os

fn read_log() {
	mut ok := false
	mut f := os.open('log.txt') or { panic(err.msg) }
	defer {
		f.close()
	}
	// ...
	if !ok {
		// defer ä»£ç å—ä¼šè¢«è°ƒç”¨ï¼Œæ–‡ä»¶ä¼šè¢«å…³é—­
		return
	}
	// ...
	// defer ä»£ç å—ä¼šè¢«è°ƒç”¨ï¼Œæ–‡ä»¶ä¼šè¢«å…³é—­
}
```

å¦‚æœå‡½æ•°æœ‰è¿”å›å€¼ï¼Œdefer ä»£ç å—ä¼šåœ¨è¿”å›è¡¨è¾¾å¼è¿è¡Œç»“æŸåå†æ‰§è¡Œã€‚

```v
import os

enum State {
	normal
	write_log
	return_error
}

// å†™æ—¥å¿—æ–‡ä»¶å¹¶è¿”å›å†™å­—èŠ‚æ•°é‡
fn write_log(s State) ?int {
	mut f := os.create('log.txt') ?
	defer {
		f.close()
	}
	if s == .write_log {
		// åœ¨ `f.writeln()` æ‰§è¡Œåï¼Œ`f.close()` æ‰ä¼šè¢«è°ƒç”¨ï¼Œå†™å­—èŠ‚æ•°ä¼šè¿”å›ç»™ `main()`
		return f.writeln('This is a log file')
	} else if s == .return_error {
		//  åœ¨ `error()` è¿”å›ä¹‹åï¼Œæ–‡ä»¶ä¼šè¢«å…³é—­ï¼Œä½†è¿”å›çš„é”™è¯¯ä¿¡æ¯ä¸­æ˜¯æ‰“å¼€çš„
		return error('nothing written; file open: $f.is_opened')
	}
	// æ–‡ä»¶åœ¨è¿™ä¹Ÿä¼šè¢«å…³é—­
	return 0
}

fn main() {
	n := write_log(.return_error) or {
		println('Error: $err')
		0
	}
	println('$n bytes written')
}
```

# ç»“æ„ä½“ Struct

```v
struct Point {
	x int
	y int
}

mut p := Point{
	x: 10
	y: 20
}
println(p.x) // ç»“æ„ä½“ä¸­å­—æ®µé€šè¿‡ç‚¹å·ä½¿ç”¨ Struct fields are accessed using a dot
// å£°æ˜ 3 ä¸ªæˆ–æ›´å°‘å­—æ®µçš„ç»“æ„ä½“çš„ç®€çŸ­è¯­æ³•
p = Point{10, 20}
assert p.x == 10
```

## å †ä¸Šçš„ç»“æ„ä½“

ç»“æ„ä½“æ˜¯åˆ†é…åœ¨æ ˆä¸Šçš„ï¼Œå¦‚æœè¦åˆ†é…åˆ°å †ä¸Šï¼Œå¹¶è·å¾—ä¸€ä¸ªåº”ç”¨ï¼Œä½¿ç”¨ `&` å‰ç¼€ï¼š

```v
struct Point {
	x int
	y int
}

p := &Point{10, 10}
// å¼•ç”¨ä½¿ç”¨ç›¸åŒçš„æ–¹å¼è·å–å­—æ®µ
println(p.x)
```

p çš„ç±»å‹æ˜¯ `&Point`ï¼Œæ˜¯ `Point` çš„å¼•ç”¨ã€‚åº”ç”¨ç±»ä¼¼äº Go çš„æŒ‡é’ˆå’Œ C++ çš„å¼•ç”¨ã€‚

## å†…åµŒç»“æ„ä½“

V æ²¡æœ‰ç»§æ‰¿ï¼Œä½†æ˜¯æ”¯æŒå†…åµŒç»“æ„ä½“ï¼š

```v
struct Widget {
mut:
	x int
	y int
}

struct Button {
	Widget
	title string
}

mut button := Button{
	title: 'Click me'
}
button.x = 3
```

æ²¡æœ‰å†…åµŒï¼Œåˆ™å¿…é¡»å‘½å Wiget å­—æ®µï¼š

```v
button.widget.x = 3
```

## é»˜è®¤å­—æ®µå€¼

```v
struct Foo {
	n   int    // n é»˜è®¤æ˜¯ 0
	s   string // s é»˜è®¤æ˜¯ ''
	a   []int  // a é»˜è®¤æ˜¯ `[]int{}`
	pos int = -1 // è‡ªå®šä¹‰é»˜è®¤å€¼
}
```

ç»“æ„ä½“åˆ›å»ºæ—¶æ‰€æœ‰å­—æ®µéƒ½ä¼šåˆ†é…é»˜è®¤é›¶å€¼ï¼Œæ•°ç»„å’Œ map ä¹Ÿä¼šåˆ†é…ã€‚ä¹Ÿå¯ä»¥è‡ªå®šä¹‰é»˜è®¤å€¼ã€‚

## å¿…é¡»çš„å­—æ®µ

```v
struct Foo {
	n int [required]
}
```

å¯ä»¥æ ‡è®°ç»“æ„ä½“ä¸­æŸä¸ªå­—æ®µ `[required]` å±æ€§ï¼Œé‚£ä¹ˆåœ¨ç»“æ„ä½“åˆ›å»ºæ—¶ï¼Œè¿™ä¸ªå­—æ®µå¿…é¡»æ˜¾å¼çš„åˆå§‹åŒ–ã€‚

## å°¾éƒ¨ç»“æ„ä½“å­—é¢è¯­æ³•

V æ²¡æœ‰é»˜è®¤å‡½æ•°å‚æ•°å’Œå‘½åå‚æ•°ï¼Œä½¿ç”¨å°¾éƒ¨ç»“æ„ä½“å­—é¢è¯­æ³•æ›¿ä»£ï¼š

```v
struct ButtonConfig {
	text        string
	is_disabled bool
	width       int = 70
	height      int = 20
}

struct Button {
	text   string
	width  int
	height int
}

fn new_button(c ButtonConfig) &Button {
	return &Button{
		width: c.width
		height: c.height
		text: c.text
	}
}

button := new_button(text: 'Click me', width: 100)
// height æ²¡æœ‰è®¾ç½®ï¼Œä½¿ç”¨é»˜è®¤å€¼
assert button.height == 20
```

new_button å‡½æ•°åŸæœ¬ä¼ å…¥ ButtonConfig ç»“æ„ä½“ï¼Œä½†æ˜¯å¯ä»¥çœç•¥ç»“æ„åå’Œå¤§æ‹¬å·ï¼ŒåŸæœ¬å†™æ³•ï¼š

```v
new_button(ButtonConfig{text:'Click me', width:100})
```

è¿™ä¸ªåªæœ‰å½“å‡½æ•°æœ€åä¸€ä¸ªå‚æ•°æ˜¯ç»“æ„ä½“æ‰æœ‰æ•ˆã€‚

## è®¿é—®ä¿®é¥°ç¬¦

ç»“æ„ä½“å­—æ®µé»˜è®¤æ˜¯ç§æœ‰å¹¶ä¸å¯å˜çš„ã€‚é€šè¿‡è®¿é—®ä¿®é¥°ç¬¦æ¥æ”¹å˜ï¼Œæ€»å…±æœ‰ 5 ç§å½¢å¼ï¼š

```v
struct Foo {
	a int // ç§æœ‰ä¸å¯å˜ï¼ˆé»˜è®¤ï¼‰
mut:
	b int // ç§æœ‰å¯å˜
	c int // å¯ä»¥åˆ—ä¸¾å¤šä¸ªåœ¨åŒä¸€ä¸ªä¿®é¥°ç¬¦ä¸‹
pub:
	d int // å…¬å¼€ä¸å¯å˜ï¼ˆåªè¯»ï¼‰
pub mut:
	e int // å…¬å¼€ä½†åªæœ‰åœ¨çˆ¶æ¨¡å—ä¸­å¯å˜
__global:
	// (ä¸æ¨èä½¿ç”¨ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ 'global' å‰é¢åŠ  __)
	f int // éšå¤„å…¬å¼€å¯å˜
}
```

ä¾‹å¦‚åœ¨ `builtin` æ¨¡å—ä¸­çš„ `string` ç±»å‹ï¼š

```v
struct string {
    str &byte
pub:
    len int
}
```

å…¶ä¸­ string å®šä¹‰ str &byte æ˜¯ç§æœ‰ä¸å¯å˜çš„ï¼Œä¸èƒ½åœ¨ `builtin` æ¨¡å—å¤–è®¿é—®ï¼Œè€Œ len æ˜¯å…¬å¼€ä¸å¯å˜çš„ï¼š

```v
fn main() {
	str := 'hello'
	len := str.len // OK
	str.len++ // ç¼–è¯‘é”™è¯¯
}
```

åœ¨ V ä¸­å®šä¹‰åªè¯»å…¬å¼€å­—æ®µæ˜¯å¾ˆå®¹æ˜“çš„ï¼Œæ— éœ€å®šä¹‰è·å–æ–¹æ³•ã€‚

## æ–¹æ³•

```v
struct User {
	age int
}

fn (u User) can_register() bool {
	return u.age > 16
}

user := User{
	age: 10
}
println(user.can_register()) // "false"
user2 := User{
	age: 20
}
println(user2.can_register()) // "true"
```

V æ²¡æœ‰ç±»ï¼Œä½†æ˜¯å¯ä»¥åœ¨ç±»å‹ä¸Šå®šä¹‰æ–¹æ³•ã€‚æ–¹æ³•æ˜¯å…·æœ‰ç‰¹æ®Šæ¥æ”¶å™¨å‚æ•°çš„å‡½æ•°ï¼Œæ¥æ”¶å™¨å‡ºç°åœ¨ fn å…³é”®å­—å’Œæ–¹æ³•åç§°ä¹‹é—´ï¼Œæœ‰å®ƒè‡ªå·±çš„å‚æ•°åˆ—è¡¨ï¼Œ æ–¹æ³•å¿…é¡»ä¸æ¥æ”¶å™¨ç±»å‹åœ¨åŒä¸€æ¨¡å—ä¸­ã€‚

åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œ`can_register` æ–¹æ³•çš„æ¥æ”¶å™¨æ˜¯ç±»å‹ User çš„å˜é‡ uã€‚è¿™é‡Œä¹ æƒ¯ä¸Šä¸ä½¿ç”¨ self å’Œ thisï¼Œè€Œæ˜¯ä¸€ä¸ªç®€çŸ­çš„æœ€å¥½å•å­—æ¯é•¿åº¦çš„åå­—ã€‚

# å…±ç”¨ä½“ Unions

å’Œç»“æ„ä½“ä¸€æ ·ï¼Œå…±ç”¨ä½“æ”¯æŒå†…åµŒï¼š

```v
struct Rgba32_Component {
	r byte
	g byte
	b byte
	a byte
}

union Rgba32 {
	Rgba32_Component
	value u32
}

clr1 := Rgba32{
	value: 0x008811FF
}

clr2 := Rgba32{
	Rgba32_Component: {
		a: 128
	}
}

sz := sizeof(Rgba32)
unsafe {
	println('Size: ${sz}B, clr1.b: $clr1.b, clr2.b: $clr2.b')
    // Size: 4B, clr1.b: 136, clr2.b: 0
}
```

å…±ç”¨ä½“æˆå‘˜å¿…é¡»åœ¨ `unsafe` å—ä¸­è®¿é—®ã€‚

æ³¨æ„ï¼šåµŒå¥—ç»“æ„ä½“å‚æ•°ä¸ä¸€å®šæ˜¯æŒ‰ç½—åˆ—é¡ºåºå­˜å‚¨çš„ã€‚

# å‡½æ•° 2

## é»˜è®¤ä¸ºçº¯å‡½æ•°

V å‡½æ•°é»˜è®¤æ˜¯çº¯å‡½æ•°ï¼Œè¿™æ„å‘³ç€è¿”å›å€¼åªæ˜¯å‡½æ•°çš„å‚æ•°ï¼Œå¹¶ä¸”å¯¹å…¶è®¡ç®—æ²¡æœ‰å‰¯ä½œç”¨ï¼ˆé™¤äº† I/Oï¼‰ã€‚

è¿™æ˜¯ç”±äºæ²¡æœ‰å…¨å±€å˜é‡å’Œæ‰€æœ‰å‡½æ•°é»˜è®¤ä¸å¯å˜å‚æ•°å¯¼è‡´çš„ï¼Œå³ä½¿ä¼ é€’çš„æ˜¯å¼•ç”¨ä¹Ÿä¸€æ ·ã€‚

ç„¶è€Œ V ä¸æ˜¯çº¯å‡½æ•°çš„è¯­è¨€ï¼Œåœ¨ç¼–è¯‘é€‰é¡¹ä¸­å¯ä»¥è®¾ç½®å¼€å¯å…¨å±€å˜é‡ï¼ˆ`-enable-globals`ï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªé€‰é¡¹æ˜¯ä¸ºåº•å±‚åº”ç”¨å¦‚å†…æ ¸ã€é©±åŠ¨æ‰€è®¾è®¡çš„ã€‚

## å¯å˜å‚æ•°

ä½¿ç”¨ mut å…³é”®å­—å¯ä»¥æ˜¯å‡½æ•°å‚æ•°å¯å˜ï¼š

```v
truct User {
	name string
mut:
	is_registered bool
}

fn (mut u User) register() {
	u.is_registered = true
}

mut user := User{}
println(user.is_registered) // "false"
user.register()
println(user.is_registered) // "true"
```

ä¸Šè¿°ä»£ç ä¸­ï¼Œæ¥æ”¶å™¨è¢«å®šä¹‰æˆå¯å˜ï¼Œåˆ™ `regiter()` å‡½æ•°å¯ä»¥æ”¹å˜å…¶å€¼ã€‚åŒæ ·ä¹Ÿé€‚ç”¨äºéæ¥æ”¶å™¨çš„å‚æ•°ï¼š

```v
fn multiply_by_2(mut arr []int) {
	for i in 0 .. arr.len {
		arr[i] *= 2
	}
}

mut nums := [1, 2, 3]
multiply_by_2(mut nums)
println(nums)
// "[2, 4, 6]"
```

æ³¨æ„åœ¨è°ƒç”¨å‡½æ•°æ˜¯å¿…é¡»åœ¨ nums å‰æ·»åŠ  mutï¼Œæ˜ç¡®å‡½æ•°è°ƒç”¨ä¼šä¿®æ”¹å…¶å€¼ã€‚

æ›´æ¨èä½¿ç”¨è¿”å›å€¼çš„æ–¹å¼æ›¿ä»£å‚æ•°ä¿®æ”¹ï¼Œå‚æ•°ä¿®æ”¹åªåº”è¯¥åœ¨æ€§èƒ½è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ä½¿ç”¨ï¼Œå‡å°‘å†…å­˜åˆ†é…å’Œæ•°æ®å¤åˆ¶ã€‚

å› æ­¤ï¼ŒV ä¸å…è®¸å¯¹åŸå§‹å˜é‡è¿›è¡Œå‚æ•°ä¿®æ”¹ï¼Œåªæœ‰å¤æ‚ç±»å‹ï¼Œå¦‚æ•°ç»„ï¼Œmap è¿™ç§å¯ä»¥ä¿®æ”¹ã€‚

ä½¿ç”¨ `user.register()` æˆ– `user = register(user)` æ›¿ä»£ `register(mut user)`ã€‚

## ç»“æ„æ›´æ–°è¯­æ³•

V æä¾›ç®€æ´çš„æ–¹å¼è¿”å›æ›´æ–°ç»“æ„ï¼š

```v
struct User {
	name          string
	age           int
	is_registered bool
}

fn register(u User) User {
	return User{
		...u
		is_registered: true
	}
}

mut user := User{
	name: 'abc'
	age: 23
}
user = register(user)
println(user)
```

## å¯å˜æ•°é‡å‚æ•°

```v
n sum(a ...int) int {
	mut total := 0
	for x in a {
		total += x
	}
	return total
}

println(sum()) // 0
println(sum(1)) // 1
println(sum(2, 3)) // 5
a := [2, 3, 4]
println(sum(...a)) // ä½¿ç”¨ ... å‰ç¼€è¿›è¡Œæ•°ç»„åˆ†è§£ï¼Œoutput: 9
b := [5, 6, 7]
println(sum(...b)) // output: 18
```

## åŒ¿åå’Œé«˜é˜¶å‡½æ•°

```v
fn sqr(n int) int {
	return n * n
}

fn cube(n int) int {
	return n * n * n
}

fn run(value int, op fn (int) int) int {
	return op(value)
}

fn main() {
	// å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°
	println(run(5, sqr)) // "25"
	// åŒ¿åå‡½æ•°å¯ä»¥å£°æ˜åœ¨ä¸€ä¸ªå‡½æ•°å†…
	double_fn := fn (n int) int {
		return n + n
	}
	println(run(5, double_fn)) // "10"
	// å‡½æ•°å¯ä»¥ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°æ—¶ä¸å£°æ˜åå­—
	res := run(5, fn (n int) int {
		return n + n
	})
	println(res) // "10"
	// å¯ä»¥å£°æ˜å‡½æ•°æ•°ç»„æˆ– map
	fns := [sqr, cube]
	println(fns[0](10)) // "100"
	fns_map := map{
		'sqr':  sqr
		'cube': cube
	}
	println(fns_map['cube'](2)) // "8"
}
```

# å¼•ç”¨

```v
struct Foo {}

fn (foo Foo) bar_method() {
	// ...
}

fn bar_function(foo Foo) {
	// ...
}
```

å¦‚æœå‡½æ•°å‚æ•°æ˜¯ä¸å¯å˜çš„ï¼ŒV å¯èƒ½é€šè¿‡å€¼æˆ–å¼•ç”¨çš„å½¢å¼ä¼ é€’ï¼Œè¿™ä¸ªç”±ç¼–è¯‘å™¨å†³å®šã€‚å¼€å‘è€…æ— éœ€å…³å¿ƒï¼Œä¸éœ€è¦å»è®°ä½ä¼ åŠ¨çš„ç»“æ„ä½“æ˜¯å€¼è¿˜æ˜¯å¼•ç”¨ã€‚å¦‚æœéœ€è¦ç¡®ä¿ä¼ é€’çš„æ˜¯å¼•ç”¨ï¼Œåˆ™åŠ ä¸Š `&`ï¼š

```v
struct Foo {
	abc int
}

fn (foo &Foo) bar() {
	println(foo.abc)
}
```

foo ä¾æ—§æ˜¯ä¸å¯å˜çš„ï¼Œå³ä½¿ä½¿ç”¨å¼•ç”¨ï¼Œè¦å¯å˜çš„è¯ï¼Œå¿…é¡»ä½¿ç”¨ `(mut foo Foo)`ã€‚

é€šå¸¸æ¥è®²ï¼ŒV çš„å¼•ç”¨ç±»ä¼¼äº Go çš„æŒ‡é’ˆå’Œ C++ çš„å¼•ç”¨ã€‚ä¸€ä¸ªæ³›å‹çš„æ ‘ç»“æ„å®šä¹‰ï¼š

```v
struct Node<T> {
	val   T
	left  &Node<T>
	right &Node<T>
}
```

# å¸¸é‡

```v
const (
	pi    = 3.14
	world = 'ä¸–ç•Œ'
)

println(pi)
println(world)
```

ä½¿ç”¨ `const` å®šä¹‰å¸¸é‡ï¼Œå¸¸é‡åªèƒ½å®šä¹‰åœ¨æ¨¡å—çº§åˆ«ï¼ˆå‡½æ•°å¤–ï¼‰ã€‚å¸¸é‡å€¼ä¸èƒ½æ”¹å˜ï¼Œä¹Ÿå¯ä»¥åˆ†å¼€å®šä¹‰ï¼š

```v
const e = 2.71828
```

V çš„å¸¸é‡æ¯”å…¶å®ƒè¯­è¨€çš„å¸¸é‡æ›´åŠ çµæ´»ï¼Œå¯ä»¥èµ‹å€¼å¤æ‚ç±»å‹ï¼š

```v
struct Color {
	r int
	g int
	b int
}

fn rgb(r int, g int, b int) Color {
	return Color{
		r: r
		g: g
		b: b
	}
}

const (
	numbers = [1, 2, 3]
	red     = Color{
		r: 255
		g: 0
		b: 0
	}
	// ä¼šåœ¨ç¼–è¯‘çš„æ—¶å€™è¯„ä¼°å‡½æ•°è°ƒç”¨*
	blue = rgb(0, 0, 255)
)

println(numbers)
println(red)
println(blue)
```

\*ç›®å‰å‡½æ•°çš„è°ƒç”¨æ˜¯åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™ã€‚æ™®é€šæƒ…å†µä¸‹å…¨å±€å˜é‡æ˜¯ä¸å…è®¸çš„ï¼Œæ‰€ä»¥è¿™å°±ååˆ†æœ‰ç”¨ã€‚

ä½¿ç”¨ `pub const` å¯ä»¥å°†å¸¸é‡å…¬å¼€ï¼š

```v
module mymodule

pub const golden_ratio = 1.61803

fn calc() {
	println(mymodule.golden_ratio)
}
```

pub å…³é”®å­—åªèƒ½åœ¨ const å…³é”®å­—ä¹‹å‰ï¼Œä¸èƒ½ç”¨åœ¨ `const ( )` ä¸­ã€‚

å£°æ˜å¸¸é‡ä½¿ç”¨ `snake_case` çš„å½¢å¼ï¼Œä¸ºäº†ä¸æœ¬åœ°å˜é‡åŒºåˆ†ï¼Œå¸¸é‡ä½¿ç”¨éƒ½è¦ç”¨æ¨¡å—åæ˜ç¡®ã€‚ä¾‹å¦‚ï¼špi å¸¸é‡ï¼Œåœ¨ math æ¨¡å—å†…å¤–ä½¿ç”¨éƒ½æ˜¯ `math.pi`ã€‚ é™¤äº† main æ¨¡å—ä¹‹å¤–ï¼Œmain æ¨¡å—ä¸­å®šä¹‰çš„å¸¸é‡æ— éœ€åŠ  `main.`ã€‚

vfmt ä¹Ÿå°±è‡ªåŠ¨è¯†åˆ«ï¼Œåœ¨æ¨¡å—å†…ä½¿ç”¨å¸¸é‡ä¸åŠ æ¨¡å—åï¼Œæ‰§è¡Œ vfmt ä¹‹åï¼Œä¼šè‡ªåŠ¨åŠ ä¸Šæ¨¡å—åã€‚

# å†…å»ºå‡½æ•°

æœ‰äº›å‡½æ•°åƒ `println` æ˜¯å†…å»ºå‡½æ•°ï¼Œæœ‰å¦‚ä¸‹ï¼š

```v
fn print(s string) // æ‰“å°ä»»ä½•ä¸œè¥¿åˆ°æ ‡å‡†è¾“å‡º
fn println(s string) // æ‰“å°ä»»ä½•ä¸œè¥¿åˆ°æ ‡å‡†è¾“å‡ºå¹¶æ¢è¡Œ

fn eprint(s string) // æ‰“å°ä»»ä½•ä¸œè¥¿åˆ°é”™è¯¯è¾“å‡º
fn eprintln(s string) // æ‰“å°ä»»ä½•ä¸œè¥¿åˆ°é”™è¯¯è¾“å‡ºå¹¶æ¢è¡Œ

fn exit(code int) // ä½¿ç”¨è‡ªå®šä¹‰å€¼é€€å‡ºç¨‹åº
fn panic(s string) // æ‰“å°ä¸€ä¸ªæ¶ˆæ¯å’Œå †æ ˆä¿¡æ¯åˆ°é”™è¯¯è¾“å‡ºï¼Œå¹¶ä»¥é”™è¯¯ç 1ç»“æŸç¨‹åº
fn print_backtrace() // æ‰“å°å †æ ˆä¿¡æ¯åˆ°é”™è¯¯è¾“å‡º
```

`println` æ˜¯ä¸€ä¸ªç®€å•ä½†å¼ºå¤§çš„å†…å»ºå‡½æ•°ï¼Œå¯ä»¥æ‰“å°ä»»ä½•ç±»å‹ï¼šstrings, numbers, arrays, maps, structsã€‚

```v
struct User {
	name string
	age  int
}

println(1) // "1"
println('hi') // "hi"
println([1, 2, 3]) // "[1, 2, 3]"
println(User{ name: 'Bob', age: 20 }) // "User{name:'Bob', age:20}"
```

# æ‰“å°è‡ªå®šä¹‰ç±»å‹

è‡ªå®šä¹‰ç±»å‹å®ç° `.str() string` æ–¹æ³•ï¼Œèƒ½è‡ªå®šä¹‰è¾“å‡ºå†…å®¹ï¼š

```v
struct Color {
	r int
	g int
	b int
}

pub fn (c Color) str() string {
	return '{$c.r, $c.g, $c.b}'
}

red := Color{
	r: 255
	g: 0
	b: 0
}
println(red) // {255, 0, 0}
```

# æ¨¡å—

åœ¨åŒä¸€ä¸ªæ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶éƒ½å±äºåŒä¸€ä¸ªæ¨¡å—ã€‚ç®€å•çš„ç¨‹åºä¸ç”¨ç‰¹åˆ«å£°æ˜æ¨¡å—ï¼Œé»˜è®¤ä¸º main æ¨¡å—ã€‚

V æ˜¯ä¸€é—¨æ¨¡å—åŒ–çš„è¯­è¨€ï¼Œé¼“åŠ±åˆ›å»ºå¯é‡å¤ä½¿ç”¨çš„æ¨¡å—ï¼Œå¹¶ä¸”åˆ›å»ºæ¨¡å—ç›¸å½“å®¹æ˜“ã€‚åªéœ€åˆ›å»ºä¸€ä¸ªæ¨¡å—åçš„ç›®å½•ï¼Œå°† .v æ–‡ä»¶æ”¾å…¥å…¶ä¸­å³å¯ï¼š

```v
cd ~/code/modules
mkdir mymodule
vim mymodule/myfile.v
```

```v
// myfile.v
module mymodule

// ä¸ºäº†æš´éœ²å‡½æ•°ï¼Œå¿…é¡»ä½¿ç”¨ `pub`
pub fn say_hi() {
	println('hello from mymodule!')
}
```

è¿™æ ·å°±å¯ä»¥åœ¨ main ä¸­ä½¿ç”¨ `mymodule`ï¼š

```v
import mymodule

fn main() {
	mymodule.say_hi()
}
```

- æ¨¡å—åæœ€å¥½ç®€çŸ­ï¼Œåœ¨ 10 ä¸ªå­—ç¬¦ä»¥ä¸‹
- æ¨¡å—åä½¿ç”¨ `snake_case` å½¢å¼
- ä¸å…è®¸æ¨¡å—å¾ªç¯è°ƒç”¨
- ä¸€ä¸ªæ¨¡å—ä¸­å¯ä»¥æœ‰è®¸å¤š .v æ–‡ä»¶
- å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹åˆ›å»ºæ¨¡å—
- æ‰€æœ‰æ¨¡å—éƒ½ä¼šè¢«é™æ€ç¼–è¯‘åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶

## åˆå§‹åŒ–å‡½æ•°

å¦‚æœæƒ³å¼•å…¥çš„æ¨¡å—èƒ½è‡ªåŠ¨è°ƒç”¨åˆå§‹åŒ–ä»£ç ï¼Œä½¿ç”¨ `init` å‡½æ•°ï¼š

```v
fn init() {
	// åˆå§‹åŒ–è‡ªåŠ¨æ‰§è¡Œçš„ä»£ç 
}
```

`init` å‡½æ•°æ˜¯ä¸èƒ½å…¬å¼€çš„ï¼Œå› ä¸ºæ˜¯è‡ªåŠ¨è°ƒç”¨çš„ã€‚è¿™ä¸ªåŠŸèƒ½å †åˆå§‹åŒ– C åº“ååˆ†æœ‰ç”¨ã€‚

## ç®¡ç†æ¨¡å—åŒ…

ç”¨æ³•ï¼š

```
v [é€‰é¡¹] [å‚æ•°]
```

é€‰é¡¹ï¼š

```
   install           ä» VPM ä¸­å®‰è£…ä¸€ä¸ªæ¨¡å—
   remove            åˆ é™¤ä¸€ä¸ªä» VPM ä¸­å®‰è£…çš„æ¨¡å—
   search            ä» VPM ä¸­æœç´¢ä¸€ä¸ªæ¨¡å—
   update            ä» VPM ä¸­æ›´æ–°ä¸€ä¸ªå·²å®‰è£…æ¨¡å—
   upgrade           æ›´æ–°æ‰€æœ‰è¿‡æ—¶çš„æ¨¡å—
   list              ç½—åˆ—æ‰€æœ‰å·²å®‰è£…çš„æ¨¡å—
   outdated          ç½—åˆ—éœ€è¦æ›´æ–°çš„å·²å®‰è£…æ¨¡å—
```

VPM æ˜¯ V Package Manager V çš„åŒ…ç®¡ç†å™¨ï¼šhttps://vpm.vlang.io/

å®‰è£…æ¨¡å—ï¼š

```sh
v install [module]
```

ä¾‹å¦‚ï¼š

```sh
v install ui
```

åˆ é™¤æ¨¡å—:

```sh
v remove [module]
```

ä¾‹å¦‚ï¼š

```sh
v remove ui
```

æ›´æ–°æ¨¡å—ï¼š

```sh
v update [module]
```

ä¾‹å¦‚ï¼š

```sh
v update ui
```

æ›´æ–°æ‰€æœ‰æ¨¡å—ï¼š

```sh
v update
```

ç½—åˆ—æ‰€æœ‰å·²å®‰è£…çš„æ¨¡å—ï¼š

```sh
v list
```

ä¾‹å¦‚ï¼š

```sh
> v list
Installed modules:
  markdown
  ui
```

ç½—åˆ—éœ€è¦æ›´æ–°çš„å·²å®‰è£…æ¨¡å—ï¼š

```sh
v outdated
```

ä¾‹å¦‚ï¼š

```sh
> v outdated
Modules are up to date.
```

## å‘å¸ƒæ¨¡å—åŒ…

1 åœ¨æ¨¡å—æ ¹ç›®å½•ä¸‹åˆ›å»º `v.mod` æ–‡ä»¶ï¼Œå¦‚æœä½¿ç”¨ `v new mymodule` æˆ– `v init` åˆ›å»ºæ¨¡å—ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆ `v.mod` ã€‚

```sh
v new mymodule
Input your project description: My nice module.
Input your project version: (0.0.0) 0.0.1
Input your project license: (MIT)
Initialising ...
Complete!
```

`v.mod` ä¾‹å­ï¼š

```v ignore
Module {
    name: 'mymodule'
    description: 'My nice module.'
    version: '0.0.1'
    license: 'MIT'
    dependencies: []
}
```

æœ€å°çš„æ–‡ä»¶ç»“æ„ï¼š

```
v.mod
mymodule.v
```

2 åœ¨ `v.mod` æ–‡ä»¶åŒç›®å½•ä¸‹åˆ›å»º git ä»“

```sh
git init
git add .
git commit -m "INIT"
```

3 åœ¨ github ä¸Šåˆ›å»ºä¸€ä¸ªå…¬å¼€ä»“ã€‚

4 å…³è” github ä¸Šçš„å…¬å¼€ä»“ï¼Œå¹¶æäº¤ä»£ç ä¸Šå»ã€‚

5 ä½¿ç”¨ github è´¦å·åœ¨ VPM ä¸Šæ³¨å†Œ https://vpm.vlang.io/newï¼Œæ·»åŠ ä½ çš„æ¨¡å—ã€‚

6 æœ€ç»ˆæ¨¡å—çš„åå­—æ˜¯ github è´¦å·å’Œæ¨¡å—åçš„æ‹¼æ¥ï¼Œä¾‹å¦‚ï¼š`mygithubname.mymodule`ã€‚

å¯é€‰ï¼šç»™æ¨¡å—æ‰“æ ‡ç­¾ï¼Œæ›´æ–¹ä¾¿æœç´¢ã€‚

# ç±»å‹å£°æ˜

## æ¥å£

## æšä¸¾

## è”åˆç±»å‹

## ç±»å‹åˆ«å

## å¯é€‰/ç»“æœç±»å‹å’Œé”™è¯¯å¤„ç†

# æ³›å‹

# å¹¶å‘

## ç”Ÿæˆå¹¶å‘ä»»åŠ¡

## ç®¡é“

## å…±äº«å¯¹è±¡

# è§£ç  JSON

# æµ‹è¯•

# å†…å­˜ç®¡ç†

## å †æ ˆ

# ORM

# æ–‡æ¡£è¾“å‡º

# å·¥å…·

## ä»£ç æ ¼å¼åŒ–

## æ€§èƒ½

# è¿›é˜¶

# é™„å½•

## é™„å½• 1ï¼šå…³é”®å­—

V æœ‰ 41 ä¸ªä¿ç•™å…³é”®å­—ï¼š

```v
as
asm
assert
atomic
break
const
continue
defer
else
embed
enum
false
fn
for
go
goto
if
import
in
interface
is
lock
match
module
mut
none
or
pub
return
rlock
select
shared
sizeof
static
struct
true
type
typeof
union
unsafe
__offsetof
```

## é™„å½• 2ï¼šæ“ä½œç¬¦

ä¸‹é¢æ“ä½œç¬¦åªé€‚ç”¨äºåŸå§‹ç±»å‹ï¼š

```v
+    sum                    integers, floats, strings
-    difference             integers, floats
*    product                integers, floats
/    quotient               integers, floats
%    remainder              integers

~    bitwise NOT            integers
&    bitwise AND            integers
|    bitwise OR             integers
^    bitwise XOR            integers

!    logical NOT            bools
&&   logical AND            bools
||   logical OR             bools
!=   logical XOR            bools

<<   left shift             integer << unsigned integer
>>   right shift            integer >> unsigned integer


Precedence    Operator
    5             *  /  %  <<  >>  &
    4             +  -  |  ^
    3             ==  !=  <  <=  >  >=
    2             &&
    1             ||


Assignment Operators
+=   -=   *=   /=   %=
&=   |=   ^=
>>=  <<=
```
