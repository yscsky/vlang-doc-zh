# vlang ä¸­æ–‡æ–‡æ¡£

ç¿»è¯‘è‡ªï¼š[vlang doc](https://github.com/vlang/v/blob/master/doc/docs.md)

# ä»‹ç»

V æ˜¯ä¸€é—¨é™æ€ç¼–è¯‘å‹è¯­è¨€ï¼Œè®¾è®¡ç”¨æ¥æ„å»ºå¯ç»´æŠ¤çš„è½¯ä»¶ ã€‚ä¸ Go ç›¸ä¼¼ï¼ŒåŒæ—¶è®¾è®¡æ—¶å‚è€ƒäº† Oberonï¼ŒRustï¼ŒSwiftï¼ŒKotlinï¼ŒPythonã€‚

V æ˜¯ä¸€é—¨ååˆ†ç®€å•çš„è¯­è¨€ï¼ŒèŠ±ç‚¹æ—¶é—´çœ‹å®Œæ•´ç¯‡æ–‡æ¡£ï¼Œä¹Ÿå°±åŸºæœ¬æŒæ¡äº† Vã€‚å¦‚æœç†Ÿæ‚‰ Goï¼Œé‚£å°±å·²ç»æŒæ¡äº† 80%ã€‚

V æ¨å´‡ä»¥æœ€å°çš„æŠ½è±¡æ¥å†™ç®€å•å¹²å‡€çš„ä»£ç ã€‚é™¤äº†ç®€å•å¤–ï¼ŒV ä¹Ÿèƒ½ç»™äºˆå¼€å‘è€…å¾ˆå¤§çš„èƒ½åŠ›ï¼Œæ‰€æœ‰èƒ½ç”¨å…¶å®ƒè¯­è¨€å®ç°çš„éƒ½èƒ½ç”¨ V å®ç°ã€‚

# å®‰è£…

æœ€ä¸»è¦çš„å®‰è£…æ–¹å¼æ˜¯ä»æºç å®‰è£…ï¼Œæ—¢ç®€å•åˆååˆ†å¿«ï¼ˆå‡ ç§’å³å¯ï¼‰ã€‚

## Linux, macOS, FreeBSD ç­‰

é¦–å…ˆéœ€è¦ gitï¼Œå’Œ C ç¼–è¯‘å™¨ï¼Œä¾‹å¦‚ï¼štccï¼Œgcc æˆ– clangï¼Œè¿˜æœ‰ makeï¼š

```shell
git clone https://github.com/vlang/v
cd v
make
# åˆ›å»ºé“¾æ¥
sudo ./v symlink
```

## Windows

é¦–å…ˆéœ€è¦ gitï¼Œå’Œ C ç¼–è¯‘å™¨ï¼Œä¾‹å¦‚ï¼štccï¼Œgcc æˆ– clangï¼Œè¿˜æœ‰ msvcï¼š

```shell
git clone https://github.com/vlang/v
cd v
make.bat -tcc
```

make.bat åé¢ä¹Ÿå¯ä»¥ä¼ é€’å…¶å®ƒå‚æ•°ï¼š-gccï¼Œ-msvcï¼Œ-clangï¼Œæ¥ä½¿ç”¨å…¶å®ƒ C ç¼–è¯‘å™¨ã€‚ä½† -tcc æ›´å°ï¼Œå®¹æ˜“å®‰è£…ï¼ˆ V ä¼šè‡ªåŠ¨ä¸‹è½½é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶ï¼‰ã€‚

æ¨èå°† v ç›®å½•æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·å¯ä»¥æ‰§è¡Œ `v.exe symlink`ã€‚

## Android

å¯ä»¥é€šè¿‡ vab å®‰è£… v å›¾å½¢åº”ç”¨åˆ° Android ä¸Šï¼Œ

V Android ä¾èµ–ï¼š**V**, **Java JDK** >= 8, Android **SDK + NDK**.

1. å®‰è£…ä¾èµ– (see [vab](https://github.com/vlang/vab))
2. è¿æ¥ä½ çš„å®‰å“è®¾å¤‡
3. è¿è¡Œ:

```shell
git clone https://github.com/vlang/vab && cd vab && v vab.v
./vab --device auto run /path/to/v/examples/sokol/particles
```

æ›´å¤šç»†èŠ‚ï¼š[vab GitHub repository](https://github.com/vlang/vab)ã€‚

# Hello World

```v
fn main() {
	println('hello world')
}
```

å°†ä¸Šè¿°ä»£ç ä¿å­˜åˆ° `hello.v`ï¼Œå†è¿è¡Œ `v run hello.v`ï¼š

```shell
v run hello.v
hello world
```

æ­å–œï¼ŒæˆåŠŸè¿è¡Œäº†ç¬¬ä¸€ä¸ª V ç¨‹åºã€‚

é€šè¿‡ `v hello.v` ç¼–è¯‘ `hello.v`ï¼Œç”Ÿæˆ hello çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç›´æ¥è¿è¡Œ `./hello`ã€‚æ›´å¤š v æŒ‡ä»¤è¯´æ˜å¯é€šè¿‡ `v help` æŸ¥çœ‹ã€‚

ä¸Šè¿°ä»£ç ä¸­ï¼Œé€šè¿‡ `fn` å£°æ˜äº†ä¸€ä¸ªåä¸º main çš„å‡½æ•°ï¼Œè¿”å›ç±»å‹å®šä¹‰åœ¨å‡½æ•°åä¹‹åï¼Œmain å‡½æ•°æ²¡æœ‰è¿”å›ä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥ main å‡½æ•°æ²¡æœ‰å®šä¹‰è¿”å›ç±»å‹ã€‚

å’Œå…¶å®ƒè¯­è¨€ï¼ˆä¾‹å¦‚ Cï¼ŒGo å’Œ Rustï¼‰ä¸€æ ·ï¼Œmain å‡½æ•°æ˜¯æ•´ä¸ªç¨‹åºçš„å…¥å£ã€‚

`println` æ˜¯å†…å»ºå‡½æ•°ï¼Œç”¨æ¥æ‰“å°å†…å®¹åˆ°æ ‡å‡†è¾“å‡ºä¸Šï¼Œä¸€èˆ¬å°±æ˜¯è¾“å‡ºåˆ°å‘½ä»¤è¡Œä¸Šã€‚

åœ¨å•æ–‡ä»¶çš„ç¨‹åºä¸­ï¼Œ`fn main()` å¯ä»¥è¢«çœç•¥ï¼Œåœ¨å†™ç±»ä¼¼è„šæœ¬çš„ä»£ç æˆ–å­¦ä¹ ä»£ç æ—¶ååˆ†ä¾¿åˆ©ã€‚å› æ­¤ï¼Œä¸ºäº†ç®€æ´ï¼Œä¸‹é¢æ•™ç¨‹ä¸­ä¼šçœç•¥ `fn main()`ã€‚

æ‰€ä»¥ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥çœç•¥æˆï¼š

```v
println('hello world')
```

ä¸€æ ·å¯ä»¥é€šè¿‡ v run è¿è¡Œã€‚

# è¿è¡Œå¤šä¸ªæ–‡ä»¶

åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­æœ‰å¤šä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ 1 ä¸ªåŒ…å« main å‡½æ•°ï¼Œå…¶å®ƒæ˜¯è¾…åŠ©å‡½æ•°ï¼Œæƒ³è¦å°†è¿™ä¸ªå‡ ä¸ªæ–‡ä»¶ç¼–è¯‘æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ `v run .`ï¼Œå¦‚æœå¸¦å‚æ•°ï¼š`v run . --yourparam some_other_stuff`ã€‚

ä¸Šè¿°å‘½ä»¤é¦–å…ˆä¼šç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œç„¶åå°†--yourparam some_other_stuff ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°ä¼ é€’åˆ°ç¨‹åºä¸­ã€‚

ç¨‹åºä¸­å¯ä»¥é€šè¿‡ä¸‹åˆ—æ–¹å¼ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°ï¼š

```v
import os

println(os.args)
```

æ³¨æ„å½“ç¨‹åºæ‰§è¡Œå®Œåï¼Œä¼šåˆ é™¤å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚æœéœ€è¦ä¿ç•™çš„è¯ï¼š

```shell
v -keepc run .
# æˆ–è€…æ‰‹åŠ¨ç¼–è¯‘
v .
```

æ³¨æ„ï¼šä»»ä½•ç¼–è¯‘å‚æ•°è¦æ”¾åœ¨ run ä¹‹å‰ï¼Œä»»ä½•ç¨‹åºæ‰§è¡Œå‚æ•°ï¼Œæ”¾åœ¨æºç ä¹‹åï¼Œå‚æ•°ä¼šåŸæ ·ä¼ é€’ç»™ç¨‹åºï¼Œv å‘½ä»¤ä¸ä¼šå¤„ç†ã€‚

# æ³¨é‡Š

```v
// è¿™æ˜¯å•è¡Œæ³¨é‡Š
/*
è¿™æ˜¯å¤šè¡Œæ³¨é‡Š
   /* å¯ä»¥å†…åµŒ */
*/
```

# å‡½æ•°

```v
fn main() {
	println(add(77, 33))
	println(sub(100, 50))
}

fn add(x int, y int) int {
	return x + y
}

fn sub(x int, y int) int {
	return x - y
}
```

å˜é‡ç±»å‹åœ¨å˜é‡åä¹‹åã€‚

ä¸ Go å’Œ C ä¸€æ ·ï¼Œå‡½æ•°ä¸èƒ½é‡è½½ï¼Œè¿™æ ·ç®€åŒ–èƒ½æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§ã€‚

å‡½æ•°å¯ä»¥åœ¨å£°æ˜å‰å°±ä½¿ç”¨ï¼Œä¾‹å¦‚ add å’Œ sub ä»£ç åœ¨ main ä¹‹åï¼Œä½†æ˜¯ main ä¸­å¯ä»¥è°ƒç”¨ã€‚è¿™é€‚ç”¨äº V ä¸­çš„æ‰€æœ‰å£°æ˜ï¼Œå¹¶ä¸”ä¸éœ€è¦å¤´æ–‡ä»¶æˆ–è€ƒè™‘æ–‡ä»¶å’Œå£°æ˜çš„é¡ºåºã€‚

## å¤šè¿”å›å€¼

```v
fn foo() (int, int) {
	return 2, 3
}

a, b := foo()
println(a) // 2
println(b) // 3
c, _ := foo() // å¿½ç•¥è¿”å›å€¼ä½¿ç”¨ `_`
```

# ç¬¦å·å¯è§æ€§

```v
pub fn public_function() {
}

fn private_function() {
}
```

å‡½æ•°é»˜è®¤æ˜¯ç§æœ‰çš„ä¸å¯¹å¤–æš´éœ²ï¼Œè¦ä½¿å¾—å…¶å®ƒæ¨¡å—å¯ä»¥ä½¿ç”¨ï¼Œéœ€è¦å‰ç½® `pub`ï¼Œå¯¹äºå¸¸é‡å’Œç±»å‹éƒ½ä¸€æ ·ã€‚

æ³¨æ„ï¼š`pub` åªèƒ½ç”¨äºè¢«å‘½åçš„æ¨¡å—ï¼Œå¦‚ä½•åˆ›å»ºæ¨¡å—å‚è§[æ¨¡å—](#æ¨¡å—)ã€‚

# å˜é‡

```v
name := 'Bob'
age := 20
large_number := i64(9999999999)
println(name)
println(age)
println(large_number)
```

ä½¿ç”¨ `:=` å£°æ˜å’Œåˆå§‹åŒ–å˜é‡ï¼Œè¿™ä¹Ÿæ˜¯ V ä¸­å”¯ä¸€çš„å£°æ˜æ–¹å¼ï¼Œè¿™ä¹Ÿè¯´æ˜å˜é‡éƒ½æœ‰åˆå§‹å€¼ã€‚

å˜é‡ç±»å‹å¯ä»¥ä»å³è¾¹å€¼ä¸­æ¨å¯¼å‡ºæ¥ï¼Œè½¬æ¢ç±»å‹çš„è¯ï¼Œé€šè¿‡ `T(v)` å°† v å€¼è½¬ä¸º T ç±»å‹ã€‚

ä¸åŒäºå…¶å®ƒè¯­è¨€ï¼ŒV åªèƒ½åœ¨å‡½æ•°ä¸­å£°æ˜å˜é‡ï¼Œå…¨å±€(æ¨¡å—)å˜é‡æ˜¯ä¸å­˜åœ¨çš„ï¼Œåœ¨ V ä¸­æ˜¯æ²¡æœ‰å…¨å±€çŠ¶æ€ï¼Œè¯¦ç»†è¯´æ˜å‚è§ï¼š[é»˜è®¤ä¸ºçº¯å‡½æ•°](#é»˜è®¤ä¸ºçº¯å‡½æ•°)ã€‚

ä¸ºä¿è¯ä»£ç é£æ ¼çš„ä¸€è‡´æ€§ï¼Œæ‰€æœ‰çš„å˜é‡å’Œå‡½æ•°åéƒ½ä½¿ç”¨ `snake_case` çš„æ ·å¼ï¼Œè€Œç±»å‹ååˆ™ä½¿ç”¨ `PascalCase` çš„æ ·å¼ã€‚

## å¯å˜å˜é‡

```v
mut age := 20
println(age)
age = 21
println(age)
```

æ”¹å˜å˜é‡çš„å€¼ä½¿ç”¨ `=`ï¼Œåœ¨ V ä¸­ï¼Œå˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ã€‚å¦‚æœè¦å¯æ”¹å˜ï¼Œåˆ™åœ¨å˜é‡å£°æ˜æ—¶åŠ  `mut`ã€‚

å¯ä»¥å°†ä¸Šé¢ä»£ç ä¸­ç¬¬ä¸€è¡Œçš„ mut å»é™¤ç¼–è¯‘è¯•è¯•ã€‚

## åˆå§‹åŒ– vs èµ‹å€¼

æ³¨æ„åŒºåˆ† `:=` å’Œ `=`ï¼Œ `:=` æ˜¯ç”¨æ¥å£°æ˜å’Œåˆå§‹åŒ–å˜é‡ï¼Œ `=` æ˜¯ç”¨æ¥èµ‹å€¼ã€‚

```v
fn main() {
	age = 21
}
```

è¿™ä¸ªä»£ç æ˜¯ç¼–è¯‘ä¸é€šè¿‡çš„ï¼Œage æ²¡æœ‰å£°æ˜ï¼Œæ‰€æœ‰å˜é‡åœ¨ V ä¸­éƒ½è¦è¢«å£°æ˜ã€‚

```v
fn main() {
	age := 21
}
```

å¤šä¸ªå˜é‡å€¼å¯ä»¥åœ¨ä¸€è¡Œä»£ç ä¸­æ”¹å˜ã€‚è¿™æ ·ï¼Œäº¤æ¢å˜é‡å€¼å¯ä»¥ä¸ç”¨ä¸­é—´å˜é‡æ¥å®ç°ã€‚

```v
mut a := 0
mut b := 1
println('$a, $b') // 0, 1
a, b = b, a
println('$a, $b') // 1, 0
```

## å˜é‡å£°æ˜çš„é”™è¯¯

åœ¨å¼€å‘æ¨¡å¼ä¸­ï¼Œæœªä½¿ç”¨çš„å˜é‡ç¼–è¯‘å™¨ä¼šå‘å‡ºè­¦å‘Šï¼Œ"unused variable"ã€‚åœ¨ç”Ÿäº§æ¨¡å¼ä¸­ï¼Œåˆ™å®Œå…¨ä¸ä¼šè¢«ç¼–è¯‘ã€‚ç”Ÿäº§æ¨¡å¼ä½¿ç”¨ï¼š`v -prod foo.v`ï¼Œç¼–è¯‘æ—¶è®¾ç½® `-prod`ã€‚

```v
fn main() {
	a := 10
	if true {
		a := 20 // error: redefinition of `a`
	}
	// warning: unused variable `a`
}
```

ä¸åŒä¸å…¶å®ƒè¯­è¨€ï¼Œå˜é‡é®è”½æ˜¯ä¸å…è®¸çš„ã€‚åœ¨å¤–éƒ¨ä»£ç å—ä¸­å·²ç»å£°æ˜äº†ä¸€ä¸ªå˜é‡ï¼Œåœ¨å…¶å†…éƒ¨ä»£ç å—ä¸­ï¼Œä¸èƒ½å†å£°æ˜åŒåçš„å˜é‡ï¼Œç¼–è¯‘ä¼šæŠ¥é”™ã€‚

ä½†æ˜¯å…è®¸é®è”½æ¨¡å—åï¼Œå› ä¸ºåœ¨æŸäº›æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼š

```v
import ui
import gg

fn draw(ctx &gg.Context) {
	gg := ctx.parent.get_ui().gg
	gg.draw_rect(10, 10, 100, 50)
}
```

# V ç±»å‹

## åŸå§‹ç±»å‹

```v
bool

string

i8    i16  int  i64
byte  u16  u32  u64

rune // Unicodeå­—ç¬¦

f32 f64

voidptr, size_t // ä¸»è¦å’Œ C äº¤äº’ä½¿ç”¨

any // ç±»ä¼¼äº C çš„ void* å’Œ Go çš„ interface{}
```

æ³¨æ„ä¸åŒäº C å’Œ Goï¼Œint éƒ½æ˜¯ 32 ä½æ•´å‹ã€‚

V ä¸­æ‰€æœ‰æ“ä½œè¦æ±‚ä¸¤è¾¹æ•°æ®ç±»å‹éƒ½è¦ä¸€è‡´ï¼Œå°çš„ç±»å‹å¯ä»¥è‡ªåŠ¨æå‡åˆ°ç¬¦åˆçš„å¤§çš„ç±»å‹ï¼Œè½¬åŒ–è§„åˆ™å¦‚ä¸‹ï¼š

```v
   i8 â†’ i16 â†’ int â†’ i64
                  â†˜     â†˜
                    f32 â†’ f64
                  â†—     â†—
 byte â†’ u16 â†’ u32 â†’ u64 â¬
      â†˜     â†˜     â†˜      ptr
   i8 â†’ i16 â†’ int â†’ i64 â¬
```

ä¾‹å¦‚ int å¯ä»¥è‡ªåŠ¨è½¬æ¢ä¸º i64 å’Œ f64ï¼Œä½†æ˜¯ä¸èƒ½ä¸º u32ï¼Œä¼šä¸¢å¤±ç¬¦å·ä½ã€‚int è½¬åŒ– f32 æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¤§æ•°å€¼çš„è¯ä¼šä¸¢å¤±ç²¾åº¦ã€‚

å­—é¢å€¼ 123 ä¼šé»˜è®¤ä¸º intï¼Œ4.56 ä¼šé»˜è®¤ä¸º f64ã€‚é™¤éæŒ‡å®šç±»å‹ï¼š

```v
u := u16(12)
v := 13 + u    // v is of type `u16` - ä¸å˜æ›´
x := f32(45.6)
y := x + 3.14  // x is of type `f32` - ä¸å˜æ›´
a := 75        // a is of type `int` - é»˜è®¤ int
b := 14.7      // b is of type `f64` - é»˜è®¤ float
c := u + a     // c is of type `int` - u ä¼šè‡ªåŠ¨è½¬æ¢ä¸º int
d := b + x     // d is of type `f64` - x ä¼šè‡ªåŠ¨è½¬æ¢ä¸º f64
```

## å­—ç¬¦ä¸²

```v
name := 'Bob'
println(name.len)
println(name[0]) // å­—ç¬¦ä¸²ç´¢å¼•ä¸º 0 çš„å­—èŠ‚ B
println(name[1..3]) // ç´¢å¼• 1 åˆ° 3 çš„å­å­—ç¬¦ä¸² 'ob'
windows_newline := '\r\n' // è½¬è¯‘å­—ç¬¦
assert windows_newline.len == 2
```

V ä¸­å­—ç¬¦ä¸²æ˜¯åªè¯»çš„å­—èŠ‚æ•°ç»„ï¼Œç”± UTF-8 ç¼–ç ï¼Œå…¶å€¼æ˜¯ä¸å¯å˜çš„ï¼Œä¸èƒ½æ”¹å˜å…¶ä¸­å€¼ï¼š

```v
mut s := 'hello ğŸŒ'
s[0] = `H` // ä¸å…è®¸
```

æ³¨æ„ç´¢å¼•å­—ç¬¦ä¸²ç”Ÿæˆçš„æ˜¯ `byte` ä¸æ˜¯ `rune`ã€‚

`rune` ç±»å‹è¦ä½¿ç”¨ ` :

```v
rocket := `ğŸš€`
assert 'aloha!'[0] == `a`
```

å•å¼•å·å’ŒåŒå¼•å·éƒ½å¯ä»¥ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚ ä¸ºä¿æŒä¸€è‡´æ€§ï¼Œé™¤éå­—ç¬¦ä¸²åŒ…å«å•å¼•å·ï¼Œå¦åˆ™ vfmt ä¼šå°†åŒå¼•å·è½¬æ¢ä¸ºå•å¼•å·ã€‚

åŸå§‹å­—ç¬¦ä¸²éœ€è¦å‰ç½® rï¼ŒåŸå§‹å­—ç¬¦ä¸²ä¸­å­—ç¬¦ä¸ä¼šè¢«è½¬è¯‘ï¼š

```v
s := r'hello\nworld'
println(s) // "hello\nworld"
```

å­—ç¬¦ä¸²å¯ä»¥å¾ˆç®€å•çš„è½¬æ¢æˆæ•°å­—ï¼š

```v
s := '42'
n := s.int() // 42
```

## Runes

`rune` è¡¨ç¤º unicode å­—ç¬¦ï¼Œæ˜¯ `u32` çš„åˆ«åã€‚ åˆ›å»ºæ–¹å¼ï¼š

```v
x := `ğŸš€`
```

å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡ `.runes()` æ–¹æ³•è½¬æ¢æˆ runesï¼š

```v
hello := 'Hello World ğŸ‘‹'
hello_runes := hello.runes() // [`H`, `e`, `l`, `l`, `o`, ` `, `W`, `o`, `r`, `l`, `d`, ` `, `ğŸ‘‹`]
```

## å­—ç¬¦ä¸²æ’å€¼

åœ¨å­—ç¬¦ä¸²ä¸­æ’å€¼ï¼Œåœ¨å˜é‡å‰ä½¿ç”¨ $ï¼Œå˜é‡ä¼šè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š

```v
name := 'Bob'
println('Hello, $name!') // Hello, Bob!
```

åŒæ ·é€‚ç”¨äºå­—æ®µï¼š`'age = $user.age'`ï¼Œæ›´å¤æ‚çš„è¡¨è¾¾å¼éœ€è¦ä½¿ç”¨ `${}`ï¼š`'can register = ${user.age > 13}'`ã€‚

æ ¼å¼åŒ–æ–¹å¼ç±»ä¼¼ C çš„ `printf()` åŒæ ·æ”¯æŒ `f`, `g`, `x` ç­‰æ ¼å¼åŒ–è¾“å‡ºå­—ç¬¦ä¸²ã€‚ç¼–è¯‘å™¨è´Ÿè´£å­˜å‚¨å¤§å°ï¼Œæ‰€ä»¥æ²¡æœ‰ `hd` or `llu`ã€‚

```v
x := 123.4567
println('x = ${x:4.2f}') // 123.46
println('[${x:10}]') // åœ¨å·¦ä¾§åŠ ç©ºæ ¼ => [   123.457]
println('[${int(x):-10}]') // åœ¨å³ä¾§åŠ ç©ºæ ¼ => [123       ]
println('[${int(x):010}]') // ç”¨ 0 å¡«å……ç©ºæ ¼ => [0000000123]
```

## å­—ç¬¦ä¸²æ“ä½œ

```v
name := 'Bob'
bobby := name + 'by' // + ç”¨æ¥ä¸²è”å­—ç¬¦ä¸²
println(bobby) // "Bobby"
mut s := 'hello '
s += 'world' // `+=` ç”¨æ¥è¿½åŠ å­—ç¬¦ä¸²
println(s) // "hello world"
```

ä¸èƒ½ç”¨ä¸€ä¸ªæ•´å‹åŠ åˆ°å­—ç¬¦ä¸²ä¸Šï¼š

```v
age := 10
println('age = ' + age) // error: infix expr: cannot use int (right expression) as string
```

è¦ä¹ˆå°†æ•´å‹è½¬æ¢æˆå­—ç¬¦ä¸²ï¼š

```v
age := 11
println('age = ' + age.str())
```

è¦ä¹ˆä½¿ç”¨å­—ç¬¦ä¸²æ’å€¼ï¼š

```v
age := 12
println('age = $age')
```

## æ•°å€¼

```v
a := 123
```

å°† 123 èµ‹å€¼ç»™ aï¼Œa é»˜è®¤æ˜¯ int ç±»å‹ã€‚

ä¹Ÿå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶ï¼ŒäºŒè¿›åˆ¶æˆ–å…«è¿›åˆ¶çš„æ ‡è®°æ³•èµ‹å€¼ï¼š

```v
a := 0x7B
b := 0b01111011
c := 0o173
```

æ‰€æœ‰å˜é‡çš„å€¼éƒ½æ˜¯ 123ï¼Œéƒ½æ˜¯ intï¼Œä¸ç®¡ç”¨ä»€ä¹ˆæ ‡è®°æ–¹å¼ã€‚

V ä¹Ÿæ”¯æŒç”¨ \_ åˆ†å‰²æ•°å­—ï¼š

```v
num := 1_000_000 // same as 1000000
three := 0b0_11 // same as 0b11
float_num := 3_122.55 // same as 3122.55
hexa := 0xF_F // same as 255
oct := 0o17_3 // same as 0o173
```

éœ€è¦è®¾ç½®ä¸åŒç±»å‹çš„æ•°å­—ï¼Œåˆ™æ˜ç¡®è®¾ç½®ç±»å‹ï¼š

```v
a := i64(123)
b := byte(42)
c := i16(12345)
```

æµ®ç‚¹æ•°çš„è®¾ç½®æ–¹å¼ç±»ä¼¼ï¼Œä¸æŒ‡å®šç±»å‹é»˜è®¤ä½¿ f64ï¼š

```v
f := 1.0
f1 := f64(3.14)
f2 := f32(3.14)
```

## æ•°ç»„

### åŸºæœ¬æ•°ç»„æ¦‚å¿µ

æ•°ç»„æ˜¯ä¸€ç³»åˆ—ç›¸åŒç±»å‹çš„å…ƒç´ çš„é›†åˆï¼Œæè¿°æ–¹å¼ä½¿ç”¨æ–¹æ‹¬å·åŒ…å«ä¸€ä¸²å…ƒç´ ã€‚å…¶ä¸­å…ƒç´ å¯ä»¥é€šè¿‡æ–¹æ‹¬å·å†…çš„ç´¢å¼•(ä» 0 å¼€å§‹)è®¿é—®ï¼š

```v
mut nums := [1, 2, 3]
println(nums) // `[1, 2, 3]`
println(nums[0]) // `1`
println(nums[1]) // `2`
nums[1] = 5
println(nums) // `[1, 5, 3]`
```

### æ•°ç»„å±æ€§

æœ‰ä¸¤ä¸ªå±æ€§æ§åˆ¶æ•°å­—çš„â€œé•¿åº¦â€ï¼š

- `len`ï¼šé•¿åº¦ - æ•°ç»„é¢„å…ˆåˆ†é…å’Œåˆå§‹åŒ–å…ƒç´ çš„æ•°é‡
- `cap`ï¼šå®¹é‡ - é¢„åˆ†é…çš„å†…å­˜ç©ºé—´å¤§å°ï¼Œä½†æ²¡æœ‰è¢«åˆå§‹åŒ–æˆ–è®¡ç®—ä½¿ç”¨ã€‚æ•°ç»„å¯ä»¥å¢é•¿åˆ°è¿™ä¸ªå¤§å°æ— éœ€é‡æ–°åˆ†é…ã€‚é€šå¸¸ V ä¼šè‡ªåŠ¨ç®¡ç†è¿™ä¸ªå±æ€§ï¼Œä½†æ˜¯ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨è®¾ç½®ã€‚

```v
mut nums := [1, 2, 3]
println(nums.len) // "3"
println(nums.cap) // "3" æˆ–æ›´å¤š
nums = [] // æ•°ç»„ç°åœ¨æ˜¯ç©ºçš„
println(nums.len) // "0"
```

æ³¨æ„ï¼Œæ•°ç»„çš„å±æ€§æ˜¯åªè¯»çš„ï¼Œç”¨æˆ·ä¸èƒ½ä¿®æ”¹ã€‚

### æ•°ç»„åˆå§‹åŒ–

åŸºæœ¬è¯­æ³•å¦‚ä¸Šæè¿°ï¼Œæ•°ç»„çš„ç±»å‹ç”±ç¬¬ä¸€ä¸ªå…ƒç´ å†³å®šï¼š

- `[1, 2, 3]` æ˜¯ä¸€ä¸ªæ•´å‹æ•°ç»„ (`[]int`)ã€‚
- `['a', 'b']` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ (`[]string`)ã€‚

ä¹Ÿå¯ä»¥æ˜ç¡®æŒ‡å®šç¬¬ä¸€ä¸ªå…ƒç´ çš„ç±»å‹ï¼š`[byte(16), 32, 64, 128]`ã€‚V çš„æ•°ç»„éƒ½æ˜¯åŒç±»å‹çš„ï¼Œæ‰€æœ‰å…ƒç´ ç±»å‹éƒ½ç›¸åŒï¼Œæ‰€ä»¥åƒ `[1, 'a']` è¿™æ ·çš„æ˜¯ç¼–è¯‘ä¸é€šè¿‡çš„ã€‚

å¯¹äºéå¸¸å¤§æˆ–è€…ç©ºæ•°ç»„æœ‰å¦ä¸€ç§åˆå§‹åŒ–æ–¹å¼ï¼š

```v
mut a := []int{len: 10000, cap: 30000, init: 3}
```

åˆ›å»ºäº†ä¸€ä¸ª 10000 ä¸ªå…ƒç´ çš„æ•´å‹æ•°ç»„ï¼Œå¹¶åˆå§‹åŒ–äº† 3 ä¸ªå…ƒç´ ã€‚å†…å­˜ä¸­åˆ†é…äº† 30000 ä¸ªå…ƒç´ å¤§å°çš„ç©ºé—´ã€‚å‚æ•° `len`ï¼Œ`cap` å’Œ `init`éƒ½æ˜¯å¯é€‰çš„ï¼›`len` é»˜è®¤æ˜¯ 0ï¼Œ`init` é»˜è®¤å€¼æ˜¯ç±»å‹çš„é»˜è®¤å€¼ï¼ˆæ•°å€¼æ˜¯ `0`ï¼Œå­—ç¬¦ä¸²æ˜¯ `''` ï¼‰ã€‚ç³»ç»Ÿè¿è¡Œæ—¶ä¼šç¡®ä¿ `cap` ä¸ä¼šå°äº `len`ï¼ˆå³ä½¿å£°æ˜è®¾ç½®çš„è¾ƒå°ï¼‰ï¼š

```v
arr := []int{len: 5, init: -1}
// `arr == [-1, -1, -1, -1, -1]`, arr.cap == 5

// å£°æ˜ä¸€ä¸ªç©ºæ•°ç»„
users := []int{}
```

è®¾ç½®å®¹é‡å¯ä»¥æé«˜æ€§èƒ½ï¼Œé¿å…æ·»åŠ å…ƒç´ æ—¶æ•°ç»„å†…å­˜çš„å†åˆ†é…ï¼š

```v
mut numbers := []int{cap: 1000}
println(numbers.len) // 0
// æ·»åŠ å…ƒç´ æ—¶ä¸ä¼šé‡æ–°åˆ†é…å†…å­˜
for i in 0 .. 1000 {
	numbers << i
}
```

æ³¨æ„ï¼šä¸Šè¿°ä»£ç ä¸­ä½¿ç”¨äº† [range for](#range for) çš„è¡¨è¾¾å¼å’Œ[ << æ“ä½œç¬¦](#æ•°ç»„æ“ä½œç¬¦)ã€‚

### æ•°ç»„ç±»å‹

ä¸€ä¸ªæ•°ç»„å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç±»å‹ï¼š

| Types        | Example Definition                   |
| ------------ | ------------------------------------ |
| Number       | `[]int,[]i64`                        |
| String       | `[]string`                           |
| Rune         | `[]rune`                             |
| Boolean      | `[]bool`                             |
| Array        | `[][]int`                            |
| Struct       | `[]MyStructName`                     |
| Channel      | `[]chan f64`                         |
| Function     | `[]MyFunctionType` `[]fn (int) bool` |
| Interface    | `[]MyInterfaceName`                  |
| Sum Type     | `[]MySumTypeName`                    |
| Generic Type | `[]T`                                |
| Map          | `[]map[string]f64`                   |
| Enum         | `[]MyEnumType`                       |
| Alias        | `[]MyAliasTypeName`                  |
| Thread       | `[]thread int`                       |
| Reference    | `[]&f64`                             |
| Shared       | `[]shared MyStructType`              |

ä¾‹ç¨‹ï¼š

è¿™ä¸ªä¾‹å­ä½¿ç”¨[ç»“æ„ä½“](#ç»“æ„ä½“)å’Œ[è”åˆç±»å‹](#è”åˆç±»å‹)æ¥åˆ›å»ºæ•°ç»„ã€‚

```v
struct Point {
	x int
	y int
}

struct Line {
	p1 Point
	p2 Point
}

type ObjectSumType = Line | Point

mut object_list := []ObjectSumType{}
object_list << Point{1, 1}
object_list << Line{
	p1: Point{3, 3}
	p2: Point{4, 4}
}
dump(object_list)
/*
object_list: [ObjectSumType(Point{
    x: 1
    y: 1
}), ObjectSumType(Line{
    p1: Point{
        x: 3
        y: 3
    }
    p2: Point{
        x: 4
        y: 4
    }
})]
*/
```

### å¤šç»´æ•°ç»„

äºŒç»´æ•°ç»„ï¼š

```v
mut a := [][]int{len: 2, init: []int{len: 3}}
a[0][1] = 2
println(a) // [[0, 2, 0], [0, 0, 0]]
```

ä¸‰ç»´æ•°ç»„ï¼š

```v
mut a := [][][]int{len: 2, init: [][]int{len: 3, init: []int{len: 2}}}
a[0][1][1] = 2
println(a) // [[[0, 0], [0, 2], [0, 0]], [[0, 0], [0, 0], [0, 0]]]
```

### æ•°ç»„æ“ä½œç¬¦

ä½¿ç”¨ `<<` æ¨é€æ“ä½œç¬¦å°†ä¸€ä¸ªå…ƒç´ æˆ–ä¸€ä¸ªæ•°ç»„åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„å°¾éƒ¨ã€‚

```v
mut nums := [1, 2, 3]
nums << 4
println(nums) // "[1, 2, 3, 4]"
// æ·»åŠ æ•°ç»„
nums << [5, 6, 7]
println(nums) // "[1, 2, 3, 4, 5, 6, 7]"
mut names := ['John']
names << 'Peter'
names << 'Sam'
// names << 10  <-- æ— æ³•ç¼–è¯‘ï¼Œnamesæ˜¯å­—ç¬¦ä¸²æ•°ç»„
```

ä½¿ç”¨ [in æ“ä½œç¬¦](#in æ“ä½œç¬¦) å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼š

```v
names := ['John', 'Peter', 'Sam']
println(names.len) // "3"
println('Alex' in names) // "false"
```

### æ•°ç»„æ–¹æ³•

æ‰€æœ‰æ•°ç»„å¯ä»¥ `println(arr)` æ‰“å°ï¼Œé€šè¿‡ `s := arr.str()` è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚

å¤åˆ¶æ•°ç»„ä½¿ç”¨ `.clone()`ï¼š

```v
nums := [1, 2, 3]
nums_copy := nums.clone()
```

ä½¿ç”¨ `.filter()` å’Œ`.map()` æ–¹æ³•å¯ä»¥é«˜æ•ˆçš„è¿‡æ»¤å’Œéå†æ•°ç»„ï¼š

```v
nums := [1, 2, 3, 4, 5, 6]
even := nums.filter(it % 2 == 0)
println(even) // [2, 4, 6]
// é€šè¿‡åŒ¿åå‡½æ•°è¿‡æ»¤
even_fn := nums.filter(fn (x int) bool {
	return x % 2 == 0
})
println(even_fn)
words := ['hello', 'world']
upper := words.map(it.to_upper())
println(upper) // ['HELLO', 'WORLD']
// é€šè¿‡åŒ¿åå‡½æ•°éå†
upper_fn := words.map(fn (w string) string {
	return w.to_upper()
})
println(upper_fn) // ['HELLO', 'WORLD']
```

`it` æ˜¯å†…å»ºå˜é‡æ¥æŒ‡ä»£å½“å‰è¿‡æ»¤æˆ–éå†è¿‡ç¨‹ä¸­çš„å…ƒç´ ã€‚

å¦å¤–ï¼Œè¿˜æä¾›äº†`.any()` å’Œ`.all()` æ–¹æ³•å¯ä»¥ä¾¿åˆ©çš„æµ‹è¯•å½“å‰å…ƒç´ æ˜¯å¦æ»¡è¶³ä¸€ä¸ªæ¡ä»¶ï¼š

```v
nums := [1, 2, 3]
println(nums.any(it == 2)) // true
println(nums.all(it >= 2)) // false
```

ä¸‹é¢æ˜¯æ•°ç»„å†…å»ºçš„æ–¹æ³•ï¼š

- `b := a.repeat(n)` å°† a æ•°ç»„çš„å…ƒç´ é‡å¤ n æ¬¡æ”¾å…¥ b æ•°ç»„
- `a.insert(i, val)` åœ¨ i ä½ç½®æ’å…¥ valï¼Œå¹¶å°†åç»­å…ƒç´ ä¾æ¬¡å¾€åç§»
- `a.insert(i, [3, 4, 5])` ä» i ä½ç½®å¼€å§‹æ’å…¥æ•°ç»„
- `a.prepend(val)` å°† val æ’å…¥åˆ°æ•°ç»„å¤´éƒ¨ï¼Œç­‰ä»·äº `a.insert(0, val)`
- `a.prepend(arr)` å°† arr æ•°ç»„æ’å…¥åˆ°æ•°ç»„å¤´éƒ¨
- `a.trim(new_len)` è£å‰ª new_len é•¿åº¦çš„æ•°ç»„ï¼Œåªæœ‰ new_len å°äºå½“å‰æ•°ç»„é•¿åº¦æ—¶æœ‰æ•ˆ
- `a.clear()`æ¸…ç©ºæ•°ç»„ï¼ˆä¸ä¼šæ”¹å˜ `cap`ï¼Œç­‰ä»·äº`a.trim(0)`ï¼‰
- `a.delete_many(start, size)` ä» start å¼€å§‹åˆ é™¤ size å¤§å°çš„è¿ç»­çš„æ•°ç»„ï¼Œä¼šè§¦å‘é‡æ–°åˆ†é…
- `a.delete(index)` åˆ é™¤ index å¤„çš„å…ƒç´ ï¼Œç­‰ä»·äº `a.delete_many(index, 1)`
- `v := a.first()` ç­‰ä»·äº `v := a[0]`
- `v := a.last()` ç­‰ä»·äº `v := a[a.len - 1]`
- `v := a.pop()` è·å–æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä»æ•°ç»„ä¸­ç§»é™¤
- `a.delete_last()` ç§»é™¤æœ€åä¸€ä¸ªå…ƒç´ 
- `b := a.reverse()` ç”Ÿæˆ a çš„ååºæ•°ç»„
- `a.reverse_in_place()` åœ¨ a ä¸­å°†å…ƒç´ çš„é¡ºåºè°ƒè½¬
- `a.join(joiner)` ä½¿ç”¨`joiner`å­—ç¬¦ä¸²ä½œä¸ºåˆ†éš”ç¬¦å°†å­—ç¬¦ä¸²æ•°ç»„è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²

### æ’åºæ•°ç»„

æ’åºæ•°ç»„çš„æ–¹å¼ååˆ†ç®€å•å’Œç›´è§‚ï¼Œç‰¹åˆ«å®šä¹‰äº† `a` å’Œ `b` æ¥æ”¯æŒè‡ªå®šä¹‰æ’åºæ¡ä»¶ã€‚

```v
mut numbers := [1, 3, 2]
numbers.sort() // 1, 2, 3
numbers.sort(a > b) // 3, 2, 1
```

```v
struct User {
	age  int
	name string
}

mut users := [User{21, 'Bob'}, User{20, 'Zarkon'}, User{25, 'Alice'}]
users.sort(a.age < b.age) // æ ¹æ® User.age æ¥æ’åº
users.sort(a.name > b.name) // æ ¹æ® User.name æ¥åå‘æ’åº
```

V æ”¯æŒè‡ªå®šä¹‰æ’åºï¼Œé€šè¿‡ `sort_with_compare` æ–¹æ³•å®ç°ï¼Œé€‚ç”¨äºéœ€è¦é€šè¿‡å¤šä¸ªå­—æ®µæ¥æ’åºçš„æƒ…å†µã€‚ä¸‹é¢çš„ä»£ç å°±é€šè¿‡ name æ¥æ­£å‘æ’åºï¼Œage æ¥åå‘æ’åºï¼š

```v
struct User {
	age  int
	name string
}

mut users := [User{21, 'Bob'}, User{65, 'Bob'}, User{25, 'Alice'}]

custom_sort_fn := fn (a &User, b &User) int {
	// return -1 å½“ a åœ¨ b ä¹‹å‰
	// return 0, ä¿æŒé¡ºåº
	// return 1 å½“ b åœ¨ a ä¹‹å‰
	if a.name == b.name {
		if a.age < b.age {
			return 1
		}
		if a.age > b.age {
			return -1
		}
		return 0
	}
	if a.name < b.name {
		return -1
	} else if a.name > b.name {
		return 1
	}
	return 0
}
users.sort_with_compare(custom_sort_fn)
```

### æ•°ç»„åˆ‡ç‰‡

åˆ‡ç‰‡æ˜¯ä¸€ä¸ªæ•°ç»„çš„éƒ¨åˆ†ï¼Œåˆå§‹åŒ–çš„æ–¹å¼æ˜¯åœ¨ç´¢å¼•å€¼ä¹‹é—´é€šè¿‡ `..` æ“ä½œç¬¦ç”Ÿæˆï¼Œå³ä¾§çš„ç´¢å¼•å€¼å¿…é¡»å¤§äºæˆ–ç­‰äºå·¦ä¾§å€¼ã€‚

å¦‚æœå³ä¾§å€¼çœç•¥ï¼Œåˆ™é»˜è®¤æ˜¯æ•°ç»„é•¿åº¦ï¼›å·¦ä¾§å€¼çœç•¥é»˜è®¤æ˜¯ 0ã€‚

```v
nums := [0, 10, 20, 30, 40]
println(nums[1..4]) // [10, 20, 30]
println(nums[..4]) // [0, 10, 20, 30]
println(nums[1..]) // [10, 20, 30, 40]
```

åœ¨ V ä¸­ï¼Œåˆ‡ç‰‡å°±æ˜¯æ•°ç»„æœ¬èº«ï¼Œå¹¶ä¸æ˜¯ä¸¤ä¸ªæˆªç„¶ä¸åŒçš„ç±»å‹ã€‚å› æ­¤ï¼Œæ•°ç»„çš„æ“ä½œåœ¨åˆ‡ç‰‡ä¸Šéƒ½èƒ½æ‰§è¡Œã€‚åˆ‡ç‰‡ä¹Ÿèƒ½è¿½åŠ åˆ°ç›¸åŒç±»å‹å…ƒç´ çš„æ•°ç»„ä¸Šï¼š

```v
array_1 := [3, 5, 4, 7, 6]
mut array_2 := [0, 1]
array_2 << array_1[..3]
println(array_2) // `[0, 1, 3, 5, 4]`
```

åˆ‡ç‰‡æ€»æ˜¯ä»¥æœ€å°çš„å®¹é‡ (`cap == len`) æ¥åˆ›å»ºï¼Œæ— è®ºæºæ•°ç»„çš„å®¹é‡å’Œé•¿åº¦æ˜¯å¤šå°‘ã€‚å½“å‘åˆ‡ç‰‡ä¸­å¢åŠ å…ƒç´ å¯¼è‡´åˆ‡ç‰‡å®¹é‡å˜åŒ–ï¼Œä¼šç«‹åˆ»é‡æ–°åˆ†é…å†…å­˜ï¼Œæ­¤æ—¶åˆ‡ç‰‡å°†ç‹¬ç«‹äºæºæ•°ç»„ï¼Œä¸ä¼šæ”¹å˜æºæ•°ç»„ï¼š

```v
mut a := [0, 1, 2, 3, 4, 5]
mut b := a[2..4]
b[0] = 7 // `b[0]` æ˜¯å¼•ç”¨è‡ª `a[2]`
println(a) // `[0, 1, 7, 3, 4, 5]`
b << 9
// `b` ä¼šé‡æ–°åˆ†é…å†…å­˜ï¼Œæ­¤æ—¶å°±ç‹¬ç«‹äº `a`
println(a) // `[0, 1, 7, 3, 4, 5]` - ä¸ä¼šæ”¹å˜
println(b) // `[7, 3, 9]`
```

å‘æºæ•°ç»„ä¸­æ·»åŠ å…ƒç´ ï¼Œå¦‚æœè¶…å‡ºå®¹é‡çš„è¯ï¼Œå†…å­˜ä¼šé‡æ–°åˆ†é…ï¼Œå¯¼è‡´æºæ•°ç»„ä¼šç‹¬ç«‹äºå­åˆ‡ç‰‡ï¼š

```v
mut a := []int{len: 5, cap: 6, init: 2}
mut b := a[1..4]
a << 3
// æ²¡æœ‰è¶…å‡º `cap` ä¸ä¼šé‡åˆ†é…
b[2] = 13 // `a[3]` æ˜¯è¢«ä¿®æ”¹çš„
a << 4
// a ä¼šè¢«é‡åˆ†é…æ­¤æ—¶ç‹¬ç«‹äº `b` (`cap` æ‰©å±•äº†)
b[1] = 3 // `a` ä¸­ä¸ä¼šå˜åŒ–
println(a) // `[2, 2, 2, 13, 2, 3, 4]`
println(b) // `[2, 3, 13]`
```

## å›ºå®šå¤§å°çš„æ•°ç»„



## Maps

# æ¨¡å—å¯¼å…¥

# æ¡ä»¶è¯­å¥

# ç»“æ„ä½“

# å…±ç”¨ä½“ Unions

# å‡½æ•° 2

## é»˜è®¤ä¸ºçº¯å‡½æ•°

# æ¨¡å—
