# V ç±»å‹

## åŸå§‹ç±»å‹

```v
bool

string

i8    i16  int  i64
byte  u16  u32  u64

rune // Unicodeå­—ç¬¦

f32 f64

voidptr, size_t // ä¸»è¦å’Œ C äº¤äº’ä½¿ç”¨

any // ç±»ä¼¼äº C çš„ void* å’Œ Go çš„ interface{}
```

æ³¨æ„ä¸åŒäº C å’Œ Goï¼Œint éƒ½æ˜¯ 32 ä½æ•´å‹ã€‚

V ä¸­æ‰€æœ‰æ“ä½œè¦æ±‚ä¸¤è¾¹æ•°æ®ç±»å‹éƒ½è¦ä¸€è‡´ï¼Œå°çš„ç±»å‹å¯ä»¥è‡ªåŠ¨æå‡åˆ°ç¬¦åˆçš„å¤§çš„ç±»å‹ï¼Œè½¬åŒ–è§„åˆ™å¦‚ä¸‹ï¼š

```v
   i8 â†’ i16 â†’ int â†’ i64
                  â†˜     â†˜
                    f32 â†’ f64
                  â†—     â†—
 byte â†’ u16 â†’ u32 â†’ u64 â¬
      â†˜     â†˜     â†˜      ptr
   i8 â†’ i16 â†’ int â†’ i64 â¬
```

ä¾‹å¦‚ int å¯ä»¥è‡ªåŠ¨è½¬æ¢ä¸º i64 å’Œ f64ï¼Œä½†æ˜¯ä¸èƒ½ä¸º u32ï¼Œä¼šä¸¢å¤±ç¬¦å·ä½ã€‚int è½¬åŒ– f32 æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¤§æ•°å€¼çš„è¯ä¼šä¸¢å¤±ç²¾åº¦ã€‚

å­—é¢å€¼ 123 ä¼šé»˜è®¤ä¸º intï¼Œ4.56 ä¼šé»˜è®¤ä¸º f64ã€‚é™¤éæŒ‡å®šç±»å‹ï¼š

```v
u := u16(12)
v := 13 + u    // v is of type `u16` - ä¸å˜æ›´
x := f32(45.6)
y := x + 3.14  // x is of type `f32` - ä¸å˜æ›´
a := 75        // a is of type `int` - é»˜è®¤ int
b := 14.7      // b is of type `f64` - é»˜è®¤ float
c := u + a     // c is of type `int` - u ä¼šè‡ªåŠ¨è½¬æ¢ä¸º int
d := b + x     // d is of type `f64` - x ä¼šè‡ªåŠ¨è½¬æ¢ä¸º f64
```

## å­—ç¬¦ä¸²

```v
name := 'Bob'
println(name.len)
println(name[0]) // å­—ç¬¦ä¸²ç´¢å¼•ä¸º 0 çš„å­—èŠ‚ B
println(name[1..3]) // ç´¢å¼• 1 åˆ° 3 çš„å­å­—ç¬¦ä¸² 'ob'
windows_newline := '\r\n' // è½¬è¯‘å­—ç¬¦
assert windows_newline.len == 2
```

V ä¸­å­—ç¬¦ä¸²æ˜¯åªè¯»çš„å­—èŠ‚æ•°ç»„ï¼Œç”± UTF-8 ç¼–ç ï¼Œå…¶å€¼æ˜¯ä¸å¯å˜çš„ï¼Œä¸èƒ½æ”¹å˜å…¶ä¸­å€¼ï¼š

```v
mut s := 'hello ğŸŒ'
s[0] = `H` // ä¸å…è®¸
```

æ³¨æ„ç´¢å¼•å­—ç¬¦ä¸²ç”Ÿæˆçš„æ˜¯ `byte` ä¸æ˜¯ `rune`ã€‚

`rune` ç±»å‹è¦ä½¿ç”¨ ` :

```v
rocket := `ğŸš€`
assert 'aloha!'[0] == `a`
```

å•å¼•å·å’ŒåŒå¼•å·éƒ½å¯ä»¥ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚ ä¸ºä¿æŒä¸€è‡´æ€§ï¼Œé™¤éå­—ç¬¦ä¸²åŒ…å«å•å¼•å·ï¼Œå¦åˆ™ vfmt ä¼šå°†åŒå¼•å·è½¬æ¢ä¸ºå•å¼•å·ã€‚

åŸå§‹å­—ç¬¦ä¸²éœ€è¦å‰ç½® rï¼ŒåŸå§‹å­—ç¬¦ä¸²ä¸­å­—ç¬¦ä¸ä¼šè¢«è½¬è¯‘ï¼š

```v
s := r'hello\nworld'
println(s) // "hello\nworld"
```

å­—ç¬¦ä¸²å¯ä»¥å¾ˆç®€å•çš„è½¬æ¢æˆæ•°å­—ï¼š

```v
s := '42'
n := s.int() // 42
```

## Runes

`rune` è¡¨ç¤º unicode å­—ç¬¦ï¼Œæ˜¯ `u32` çš„åˆ«åã€‚ åˆ›å»ºæ–¹å¼ï¼š

```v
x := `ğŸš€`
```

å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡ `.runes()` æ–¹æ³•è½¬æ¢æˆ runesï¼š

```v
hello := 'Hello World ğŸ‘‹'
hello_runes := hello.runes() // [`H`, `e`, `l`, `l`, `o`, ` `, `W`, `o`, `r`, `l`, `d`, ` `, `ğŸ‘‹`]
```

## å­—ç¬¦ä¸²æ’å€¼

åœ¨å­—ç¬¦ä¸²ä¸­æ’å€¼ï¼Œåœ¨å˜é‡å‰ä½¿ç”¨ $ï¼Œå˜é‡ä¼šè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š

```v
name := 'Bob'
println('Hello, $name!') // Hello, Bob!
```

åŒæ ·é€‚ç”¨äºå­—æ®µï¼š`'age = $user.age'`ï¼Œæ›´å¤æ‚çš„è¡¨è¾¾å¼éœ€è¦ä½¿ç”¨ `${}`ï¼š`'can register = ${user.age > 13}'`ã€‚

æ ¼å¼åŒ–æ–¹å¼ç±»ä¼¼ C çš„ `printf()` åŒæ ·æ”¯æŒ `f`, `g`, `x` ç­‰æ ¼å¼åŒ–è¾“å‡ºå­—ç¬¦ä¸²ã€‚ç¼–è¯‘å™¨è´Ÿè´£å­˜å‚¨å¤§å°ï¼Œæ‰€ä»¥æ²¡æœ‰ `hd` or `llu`ã€‚

```v
x := 123.4567
println('x = ${x:4.2f}') // 123.46
println('[${x:10}]') // åœ¨å·¦ä¾§åŠ ç©ºæ ¼ => [   123.457]
println('[${int(x):-10}]') // åœ¨å³ä¾§åŠ ç©ºæ ¼ => [123       ]
println('[${int(x):010}]') // ç”¨ 0 å¡«å……ç©ºæ ¼ => [0000000123]
```

## å­—ç¬¦ä¸²æ“ä½œ

```v
name := 'Bob'
bobby := name + 'by' // + ç”¨æ¥ä¸²è”å­—ç¬¦ä¸²
println(bobby) // "Bobby"
mut s := 'hello '
s += 'world' // `+=` ç”¨æ¥è¿½åŠ å­—ç¬¦ä¸²
println(s) // "hello world"
```

ä¸èƒ½ç”¨ä¸€ä¸ªæ•´å‹åŠ åˆ°å­—ç¬¦ä¸²ä¸Šï¼š

```v
age := 10
println('age = ' + age) // error: infix expr: cannot use int (right expression) as string
```

è¦ä¹ˆå°†æ•´å‹è½¬æ¢æˆå­—ç¬¦ä¸²ï¼š

```v
age := 11
println('age = ' + age.str())
```

è¦ä¹ˆä½¿ç”¨å­—ç¬¦ä¸²æ’å€¼ï¼š

```v
age := 12
println('age = $age')
```

## æ•°å€¼

```v
a := 123
```

å°† 123 èµ‹å€¼ç»™ aï¼Œa é»˜è®¤æ˜¯ int ç±»å‹ã€‚

ä¹Ÿå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶ï¼ŒäºŒè¿›åˆ¶æˆ–å…«è¿›åˆ¶çš„æ ‡è®°æ³•èµ‹å€¼ï¼š

```v
a := 0x7B
b := 0b01111011
c := 0o173
```

æ‰€æœ‰å˜é‡çš„å€¼éƒ½æ˜¯ 123ï¼Œéƒ½æ˜¯ intï¼Œä¸ç®¡ç”¨ä»€ä¹ˆæ ‡è®°æ–¹å¼ã€‚

V ä¹Ÿæ”¯æŒç”¨ \_ åˆ†å‰²æ•°å­—ï¼š

```v
num := 1_000_000 // same as 1000000
three := 0b0_11 // same as 0b11
float_num := 3_122.55 // same as 3122.55
hexa := 0xF_F // same as 255
oct := 0o17_3 // same as 0o173
```

éœ€è¦è®¾ç½®ä¸åŒç±»å‹çš„æ•°å­—ï¼Œåˆ™æ˜ç¡®è®¾ç½®ç±»å‹ï¼š

```v
a := i64(123)
b := byte(42)
c := i16(12345)
```

æµ®ç‚¹æ•°çš„è®¾ç½®æ–¹å¼ç±»ä¼¼ï¼Œä¸æŒ‡å®šç±»å‹é»˜è®¤ä½¿ f64ï¼š

```v
f := 1.0
f1 := f64(3.14)
f2 := f32(3.14)
```

## æ•°ç»„

### åŸºæœ¬æ•°ç»„æ¦‚å¿µ

æ•°ç»„æ˜¯ä¸€ç³»åˆ—ç›¸åŒç±»å‹çš„å…ƒç´ çš„é›†åˆï¼Œæè¿°æ–¹å¼ä½¿ç”¨æ–¹æ‹¬å·åŒ…å«ä¸€ä¸²å…ƒç´ ã€‚å…¶ä¸­å…ƒç´ å¯ä»¥é€šè¿‡æ–¹æ‹¬å·å†…çš„ç´¢å¼•(ä» 0 å¼€å§‹)è®¿é—®ï¼š

```v
mut nums := [1, 2, 3]
println(nums) // `[1, 2, 3]`
println(nums[0]) // `1`
println(nums[1]) // `2`
nums[1] = 5
println(nums) // `[1, 5, 3]`
```

### æ•°ç»„å±æ€§

æœ‰ä¸¤ä¸ªå±æ€§æ§åˆ¶æ•°å­—çš„â€œé•¿åº¦â€ï¼š

- `len`ï¼šé•¿åº¦ - æ•°ç»„é¢„å…ˆåˆ†é…å’Œåˆå§‹åŒ–å…ƒç´ çš„æ•°é‡
- `cap`ï¼šå®¹é‡ - é¢„åˆ†é…çš„å†…å­˜ç©ºé—´å¤§å°ï¼Œä½†æ²¡æœ‰è¢«åˆå§‹åŒ–æˆ–è®¡ç®—ä½¿ç”¨ã€‚æ•°ç»„å¯ä»¥å¢é•¿åˆ°è¿™ä¸ªå¤§å°æ— éœ€é‡æ–°åˆ†é…ã€‚é€šå¸¸ V ä¼šè‡ªåŠ¨ç®¡ç†è¿™ä¸ªå±æ€§ï¼Œä½†æ˜¯ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨è®¾ç½®ã€‚

```v
mut nums := [1, 2, 3]
println(nums.len) // "3"
println(nums.cap) // "3" æˆ–æ›´å¤š
nums = [] // æ•°ç»„ç°åœ¨æ˜¯ç©ºçš„
println(nums.len) // "0"
```

æ³¨æ„ï¼Œæ•°ç»„çš„å±æ€§æ˜¯åªè¯»çš„ï¼Œç”¨æˆ·ä¸èƒ½ä¿®æ”¹ã€‚

### æ•°ç»„åˆå§‹åŒ–

åŸºæœ¬è¯­æ³•å¦‚ä¸Šæè¿°ï¼Œæ•°ç»„çš„ç±»å‹ç”±ç¬¬ä¸€ä¸ªå…ƒç´ å†³å®šï¼š

- `[1, 2, 3]` æ˜¯ä¸€ä¸ªæ•´å‹æ•°ç»„ (`[]int`)ã€‚
- `['a', 'b']` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ (`[]string`)ã€‚

ä¹Ÿå¯ä»¥æ˜ç¡®æŒ‡å®šç¬¬ä¸€ä¸ªå…ƒç´ çš„ç±»å‹ï¼š`[byte(16), 32, 64, 128]`ã€‚V çš„æ•°ç»„éƒ½æ˜¯åŒç±»å‹çš„ï¼Œæ‰€æœ‰å…ƒç´ ç±»å‹éƒ½ç›¸åŒï¼Œæ‰€ä»¥åƒ `[1, 'a']` è¿™æ ·çš„æ˜¯ç¼–è¯‘ä¸é€šè¿‡çš„ã€‚

å¯¹äºéå¸¸å¤§æˆ–è€…ç©ºæ•°ç»„æœ‰å¦ä¸€ç§åˆå§‹åŒ–æ–¹å¼ï¼š

```v
mut a := []int{len: 10000, cap: 30000, init: 3}
```

åˆ›å»ºäº†ä¸€ä¸ª 10000 ä¸ªå…ƒç´ çš„æ•´å‹æ•°ç»„ï¼Œå¹¶åˆå§‹åŒ–äº† 3 ä¸ªå…ƒç´ ã€‚å†…å­˜ä¸­åˆ†é…äº† 30000 ä¸ªå…ƒç´ å¤§å°çš„ç©ºé—´ã€‚å‚æ•° `len`ï¼Œ`cap` å’Œ `init`éƒ½æ˜¯å¯é€‰çš„ï¼›`len` é»˜è®¤æ˜¯ 0ï¼Œ`init` é»˜è®¤å€¼æ˜¯ç±»å‹çš„é»˜è®¤å€¼ï¼ˆæ•°å€¼æ˜¯ `0`ï¼Œå­—ç¬¦ä¸²æ˜¯ `''` ï¼‰ã€‚ç³»ç»Ÿè¿è¡Œæ—¶ä¼šç¡®ä¿ `cap` ä¸ä¼šå°äº `len`ï¼ˆå³ä½¿å£°æ˜è®¾ç½®çš„è¾ƒå°ï¼‰ï¼š

```v
arr := []int{len: 5, init: -1}
// `arr == [-1, -1, -1, -1, -1]`, arr.cap == 5

// å£°æ˜ä¸€ä¸ªç©ºæ•°ç»„
users := []int{}
```

è®¾ç½®å®¹é‡å¯ä»¥æé«˜æ€§èƒ½ï¼Œé¿å…æ·»åŠ å…ƒç´ æ—¶æ•°ç»„å†…å­˜çš„å†åˆ†é…ï¼š

```v
mut numbers := []int{cap: 1000}
println(numbers.len) // 0
// æ·»åŠ å…ƒç´ æ—¶ä¸ä¼šé‡æ–°åˆ†é…å†…å­˜
for i in 0 .. 1000 {
	numbers << i
}
```

æ³¨æ„ï¼šä¸Šè¿°ä»£ç ä¸­ä½¿ç”¨äº† [range for](#range for) çš„è¡¨è¾¾å¼å’Œ[ << æ“ä½œç¬¦](#æ•°ç»„æ“ä½œç¬¦)ã€‚

### æ•°ç»„ç±»å‹

ä¸€ä¸ªæ•°ç»„å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç±»å‹ï¼š

| Types        | Example Definition                   |
| ------------ | ------------------------------------ |
| Number       | `[]int,[]i64`                        |
| String       | `[]string`                           |
| Rune         | `[]rune`                             |
| Boolean      | `[]bool`                             |
| Array        | `[][]int`                            |
| Struct       | `[]MyStructName`                     |
| Channel      | `[]chan f64`                         |
| Function     | `[]MyFunctionType` `[]fn (int) bool` |
| Interface    | `[]MyInterfaceName`                  |
| Sum Type     | `[]MySumTypeName`                    |
| Generic Type | `[]T`                                |
| Map          | `[]map[string]f64`                   |
| Enum         | `[]MyEnumType`                       |
| Alias        | `[]MyAliasTypeName`                  |
| Thread       | `[]thread int`                       |
| Reference    | `[]&f64`                             |
| Shared       | `[]shared MyStructType`              |

ä¾‹ç¨‹ï¼š

è¿™ä¸ªä¾‹å­ä½¿ç”¨[ç»“æ„ä½“](#ç»“æ„ä½“)å’Œ[è”åˆç±»å‹](#è”åˆç±»å‹)æ¥åˆ›å»ºæ•°ç»„ã€‚

```v
struct Point {
	x int
	y int
}

struct Line {
	p1 Point
	p2 Point
}

type ObjectSumType = Line | Point

mut object_list := []ObjectSumType{}
object_list << Point{1, 1}
object_list << Line{
	p1: Point{3, 3}
	p2: Point{4, 4}
}
dump(object_list)
/*
object_list: [ObjectSumType(Point{
    x: 1
    y: 1
}), ObjectSumType(Line{
    p1: Point{
        x: 3
        y: 3
    }
    p2: Point{
        x: 4
        y: 4
    }
})]
*/
```

### å¤šç»´æ•°ç»„

äºŒç»´æ•°ç»„ï¼š

```v
mut a := [][]int{len: 2, init: []int{len: 3}}
a[0][1] = 2
println(a) // [[0, 2, 0], [0, 0, 0]]
```

ä¸‰ç»´æ•°ç»„ï¼š

```v
mut a := [][][]int{len: 2, init: [][]int{len: 3, init: []int{len: 2}}}
a[0][1][1] = 2
println(a) // [[[0, 0], [0, 2], [0, 0]], [[0, 0], [0, 0], [0, 0]]]
```

### æ•°ç»„æ“ä½œç¬¦

ä½¿ç”¨ `<<` æ¨é€æ“ä½œç¬¦å°†ä¸€ä¸ªå…ƒç´ æˆ–ä¸€ä¸ªæ•°ç»„åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„å°¾éƒ¨ã€‚

```v
mut nums := [1, 2, 3]
nums << 4
println(nums) // "[1, 2, 3, 4]"
// æ·»åŠ æ•°ç»„
nums << [5, 6, 7]
println(nums) // "[1, 2, 3, 4, 5, 6, 7]"
mut names := ['John']
names << 'Peter'
names << 'Sam'
// names << 10  <-- æ— æ³•ç¼–è¯‘ï¼Œnamesæ˜¯å­—ç¬¦ä¸²æ•°ç»„
```

ä½¿ç”¨ [in æ“ä½œç¬¦](#in æ“ä½œç¬¦) å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼š

```v
names := ['John', 'Peter', 'Sam']
println(names.len) // "3"
println('Alex' in names) // "false"
```

### æ•°ç»„æ–¹æ³•

æ‰€æœ‰æ•°ç»„å¯ä»¥ `println(arr)` æ‰“å°ï¼Œé€šè¿‡ `s := arr.str()` è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚

å¤åˆ¶æ•°ç»„ä½¿ç”¨ `.clone()`ï¼š

```v
nums := [1, 2, 3]
nums_copy := nums.clone()
```

ä½¿ç”¨ `.filter()` å’Œ`.map()` æ–¹æ³•å¯ä»¥é«˜æ•ˆçš„è¿‡æ»¤å’Œéå†æ•°ç»„ï¼š

```v
nums := [1, 2, 3, 4, 5, 6]
even := nums.filter(it % 2 == 0)
println(even) // [2, 4, 6]
// é€šè¿‡åŒ¿åå‡½æ•°è¿‡æ»¤
even_fn := nums.filter(fn (x int) bool {
	return x % 2 == 0
})
println(even_fn)
words := ['hello', 'world']
upper := words.map(it.to_upper())
println(upper) // ['HELLO', 'WORLD']
// é€šè¿‡åŒ¿åå‡½æ•°éå†
upper_fn := words.map(fn (w string) string {
	return w.to_upper()
})
println(upper_fn) // ['HELLO', 'WORLD']
```

`it` æ˜¯å†…å»ºå˜é‡æ¥æŒ‡ä»£å½“å‰è¿‡æ»¤æˆ–éå†è¿‡ç¨‹ä¸­çš„å…ƒç´ ã€‚

å¦å¤–ï¼Œè¿˜æä¾›äº†`.any()` å’Œ`.all()` æ–¹æ³•å¯ä»¥ä¾¿åˆ©çš„æµ‹è¯•å½“å‰å…ƒç´ æ˜¯å¦æ»¡è¶³ä¸€ä¸ªæ¡ä»¶ï¼š

```v
nums := [1, 2, 3]
println(nums.any(it == 2)) // true
println(nums.all(it >= 2)) // false
```

ä¸‹é¢æ˜¯æ•°ç»„å†…å»ºçš„æ–¹æ³•ï¼š

- `b := a.repeat(n)` å°† a æ•°ç»„çš„å…ƒç´ é‡å¤ n æ¬¡æ”¾å…¥ b æ•°ç»„
- `a.insert(i, val)` åœ¨ i ä½ç½®æ’å…¥ valï¼Œå¹¶å°†åç»­å…ƒç´ ä¾æ¬¡å¾€åç§»
- `a.insert(i, [3, 4, 5])` ä» i ä½ç½®å¼€å§‹æ’å…¥æ•°ç»„
- `a.prepend(val)` å°† val æ’å…¥åˆ°æ•°ç»„å¤´éƒ¨ï¼Œç­‰ä»·äº `a.insert(0, val)`
- `a.prepend(arr)` å°† arr æ•°ç»„æ’å…¥åˆ°æ•°ç»„å¤´éƒ¨
- `a.trim(new_len)` è£å‰ª new_len é•¿åº¦çš„æ•°ç»„ï¼Œåªæœ‰ new_len å°äºå½“å‰æ•°ç»„é•¿åº¦æ—¶æœ‰æ•ˆ
- `a.clear()`æ¸…ç©ºæ•°ç»„ï¼ˆä¸ä¼šæ”¹å˜ `cap`ï¼Œç­‰ä»·äº`a.trim(0)`ï¼‰
- `a.delete_many(start, size)` ä» start å¼€å§‹åˆ é™¤ size å¤§å°çš„è¿ç»­çš„æ•°ç»„ï¼Œä¼šè§¦å‘é‡æ–°åˆ†é…
- `a.delete(index)` åˆ é™¤ index å¤„çš„å…ƒç´ ï¼Œç­‰ä»·äº `a.delete_many(index, 1)`
- `v := a.first()` ç­‰ä»·äº `v := a[0]`
- `v := a.last()` ç­‰ä»·äº `v := a[a.len - 1]`
- `v := a.pop()` è·å–æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä»æ•°ç»„ä¸­ç§»é™¤
- `a.delete_last()` ç§»é™¤æœ€åä¸€ä¸ªå…ƒç´ 
- `b := a.reverse()` ç”Ÿæˆ a çš„ååºæ•°ç»„
- `a.reverse_in_place()` åœ¨ a ä¸­å°†å…ƒç´ çš„é¡ºåºè°ƒè½¬
- `a.join(joiner)` ä½¿ç”¨`joiner`å­—ç¬¦ä¸²ä½œä¸ºåˆ†éš”ç¬¦å°†å­—ç¬¦ä¸²æ•°ç»„è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²

### æ’åºæ•°ç»„

æ’åºæ•°ç»„çš„æ–¹å¼ååˆ†ç®€å•å’Œç›´è§‚ï¼Œç‰¹åˆ«å®šä¹‰äº† `a` å’Œ `b` æ¥æ”¯æŒè‡ªå®šä¹‰æ’åºæ¡ä»¶ã€‚

```v
mut numbers := [1, 3, 2]
numbers.sort() // 1, 2, 3
numbers.sort(a > b) // 3, 2, 1
```

```v
struct User {
	age  int
	name string
}

mut users := [User{21, 'Bob'}, User{20, 'Zarkon'}, User{25, 'Alice'}]
users.sort(a.age < b.age) // æ ¹æ® User.age æ¥æ’åº
users.sort(a.name > b.name) // æ ¹æ® User.name æ¥åå‘æ’åº
```

V æ”¯æŒè‡ªå®šä¹‰æ’åºï¼Œé€šè¿‡ `sort_with_compare` æ–¹æ³•å®ç°ï¼Œé€‚ç”¨äºéœ€è¦é€šè¿‡å¤šä¸ªå­—æ®µæ¥æ’åºçš„æƒ…å†µã€‚ä¸‹é¢çš„ä»£ç å°±é€šè¿‡ name æ¥æ­£å‘æ’åºï¼Œage æ¥åå‘æ’åºï¼š

```v
struct User {
	age  int
	name string
}

mut users := [User{21, 'Bob'}, User{65, 'Bob'}, User{25, 'Alice'}]

custom_sort_fn := fn (a &User, b &User) int {
	// return -1 å½“ a åœ¨ b ä¹‹å‰
	// return 0, ä¿æŒé¡ºåº
	// return 1 å½“ b åœ¨ a ä¹‹å‰
	if a.name == b.name {
		if a.age < b.age {
			return 1
		}
		if a.age > b.age {
			return -1
		}
		return 0
	}
	if a.name < b.name {
		return -1
	} else if a.name > b.name {
		return 1
	}
	return 0
}
users.sort_with_compare(custom_sort_fn)
```

### æ•°ç»„åˆ‡ç‰‡

åˆ‡ç‰‡æ˜¯ä¸€ä¸ªæ•°ç»„çš„éƒ¨åˆ†ï¼Œåˆå§‹åŒ–çš„æ–¹å¼æ˜¯åœ¨ç´¢å¼•å€¼ä¹‹é—´é€šè¿‡ `..` æ“ä½œç¬¦ç”Ÿæˆï¼Œå³ä¾§çš„ç´¢å¼•å€¼å¿…é¡»å¤§äºæˆ–ç­‰äºå·¦ä¾§å€¼ã€‚

å¦‚æœå³ä¾§å€¼çœç•¥ï¼Œåˆ™é»˜è®¤æ˜¯æ•°ç»„é•¿åº¦ï¼›å·¦ä¾§å€¼çœç•¥é»˜è®¤æ˜¯ 0ã€‚

```v
nums := [0, 10, 20, 30, 40]
println(nums[1..4]) // [10, 20, 30]
println(nums[..4]) // [0, 10, 20, 30]
println(nums[1..]) // [10, 20, 30, 40]
```

åœ¨ V ä¸­ï¼Œåˆ‡ç‰‡å°±æ˜¯æ•°ç»„æœ¬èº«ï¼Œå¹¶ä¸æ˜¯ä¸¤ä¸ªæˆªç„¶ä¸åŒçš„ç±»å‹ã€‚å› æ­¤ï¼Œæ•°ç»„çš„æ“ä½œåœ¨åˆ‡ç‰‡ä¸Šéƒ½èƒ½æ‰§è¡Œã€‚åˆ‡ç‰‡ä¹Ÿèƒ½è¿½åŠ åˆ°ç›¸åŒç±»å‹å…ƒç´ çš„æ•°ç»„ä¸Šï¼š

```v
array_1 := [3, 5, 4, 7, 6]
mut array_2 := [0, 1]
array_2 << array_1[..3]
println(array_2) // `[0, 1, 3, 5, 4]`
```

åˆ‡ç‰‡æ€»æ˜¯ä»¥æœ€å°çš„å®¹é‡ (`cap == len`) æ¥åˆ›å»ºï¼Œæ— è®ºæºæ•°ç»„çš„å®¹é‡å’Œé•¿åº¦æ˜¯å¤šå°‘ã€‚å½“å‘åˆ‡ç‰‡ä¸­å¢åŠ å…ƒç´ å¯¼è‡´åˆ‡ç‰‡å®¹é‡å˜åŒ–ï¼Œä¼šç«‹åˆ»é‡æ–°åˆ†é…å†…å­˜ï¼Œæ­¤æ—¶åˆ‡ç‰‡å°†ç‹¬ç«‹äºæºæ•°ç»„ï¼Œä¸ä¼šæ”¹å˜æºæ•°ç»„ï¼š

```v
mut a := [0, 1, 2, 3, 4, 5]
mut b := a[2..4]
b[0] = 7 // `b[0]` æ˜¯å¼•ç”¨è‡ª `a[2]`
println(a) // `[0, 1, 7, 3, 4, 5]`
b << 9
// `b` ä¼šé‡æ–°åˆ†é…å†…å­˜ï¼Œæ­¤æ—¶å°±ç‹¬ç«‹äº `a`
println(a) // `[0, 1, 7, 3, 4, 5]` - ä¸ä¼šæ”¹å˜
println(b) // `[7, 3, 9]`
```

å‘æºæ•°ç»„ä¸­æ·»åŠ å…ƒç´ ï¼Œå¦‚æœè¶…å‡ºå®¹é‡çš„è¯ï¼Œå†…å­˜ä¼šé‡æ–°åˆ†é…ï¼Œå¯¼è‡´æºæ•°ç»„ä¼šç‹¬ç«‹äºå­åˆ‡ç‰‡ï¼š

```v
mut a := []int{len: 5, cap: 6, init: 2}
mut b := a[1..4]
a << 3
// æ²¡æœ‰è¶…å‡º `cap` ä¸ä¼šé‡åˆ†é…
b[2] = 13 // `a[3]` æ˜¯è¢«ä¿®æ”¹çš„
a << 4
// a ä¼šè¢«é‡åˆ†é…æ­¤æ—¶ç‹¬ç«‹äº `b` (`cap` æ‰©å±•äº†)
b[1] = 3 // `a` ä¸­ä¸ä¼šå˜åŒ–
println(a) // `[2, 2, 2, 13, 2, 3, 4]`
println(b) // `[2, 3, 13]`
```

## å›ºå®šå¤§å°çš„æ•°ç»„

V ä¹ŸåŒæ ·æ”¯æŒå›ºå®šå¤§å°çš„æ•°ç»„ï¼Œä¸åŒäºå¸¸è§„æ•°ç»„ï¼Œå…¶é•¿åº¦æ—¶å›ºå®šçš„ï¼Œä¸èƒ½æ·»åŠ åˆ é™¤å…ƒç´ ï¼Œä½†æ˜¯å¯ä»¥ä¿®æ”¹å…ƒç´ ã€‚

å›ºå®šå¤§å°æ•°ç»„æ¯”å¸¸è§„æ•°ç»„æ›´åŠ é«˜æ•ˆï¼ŒèŠ‚çœå†…å­˜ã€‚å®ƒä»¬çš„æ•°æ®æ˜¯å­˜æ”¾åœ¨æ ˆä¸Šï¼Œæ‰€ä»¥å¯ä»¥å½“ç¼“å­˜ä¸€æ ·ä½¿ç”¨ï¼Œé¿å…åœ¨å †ä¸Šè¿›è¡Œé¢å¤–çš„å¼€é”€ã€‚

å¤§å¤šæ•°æ–¹æ³•åªé€‚ç”¨äºå¸¸è§„æ•°ç»„ï¼Œä¸é€‚ç”¨äºå›ºå®šå¤§å°æ•°ç»„ã€‚å¯ä»¥å°†å›ºå®šå¤§å°æ•°ç»„è½¬æ¢æˆæ•°ç»„åˆ‡é¢ä½¿ç”¨ã€‚

```v
mut fnums := [3]int{} // fnums æ˜¯å›ºå®šå¤§å° 3 çš„æ•°ç»„
fnums[0] = 1
fnums[1] = 10
fnums[2] = 100
println(fnums) // => [1, 10, 100]
println(typeof(fnums).name) // => [3]int

fnums2 := [1, 10, 100]! // å›ºå®šå¤§å°æ•°ç»„ç®€çŸ­çš„å£°æ˜æ–¹å¼ï¼ˆè¿™ä¸ªè¯­æ³•å¯èƒ½ä¼šæ”¹å˜ï¼‰

anums := fnums[0..fnums.len]
println(anums) // => [1, 10, 100]
println(typeof(anums).name) // => []int
```

æ³¨æ„ï¼Œåˆ‡ç‰‡çš„æ–¹å¼ä¼šå¯¼è‡´å¤åˆ¶å›ºå®šå¤§å°æ•°ç»„çš„æ•°æ®åˆ°ä¸€ä¸ªæ–°çš„å¸¸è§„æ•°ç»„ä¸­ã€‚

## Maps

```v
mut m := map[string]int{} // é”®æ˜¯ `string` å€¼æ˜¯ `int` çš„ map
m['one'] = 1
m['two'] = 2
println(m['one']) // "1"
println(m['bad_key']) // "0"
println('bad_key' in m) // `in` å¯ä»¥æ£€æµ‹æ˜¯å¦æœ‰è¿™ä¸ªé”®å­˜åœ¨
m.delete('two')
```

Maps çš„é”®ç±»å‹å¯ä»¥æ˜¯ string, rune, integer, float æˆ– voidptrã€‚

å¯ä»¥ä½¿ç”¨çŸ­å£°æ˜çš„è¯­æ³•å£°æ˜ mapï¼š

```v
numbers := map{
	'one': 1
	'two': 2
}
println(numbers)
```

å¦‚æœæ‰¾ä¸åˆ°é”®ï¼Œä¼šè¿”å›é›¶å€¼ï¼š

```v
sm := map{
	'abc': 'xyz'
}
val := sm['bad_key']
println(val) // ''

intm := map{
	1: 1234
	2: 5678
}
s := intm[3]
println(s) // 0
```

ä¹Ÿå¯ä»¥ä½¿ç”¨ `or {}` è¯­æ³•å¤„ç†æœªæ‰¾åˆ°é”®çš„æƒ…å†µï¼š

```v
mm := map[string]int{}
val := mm['bad_key'] or { panic('key not found') }
```

åŒæ ·ä¹Ÿèƒ½åœ¨æ•°ç»„ä¸­ä½¿ç”¨ `or {}`ï¼š

```v
arr := [1, 2, 3]
large_index := 999
val := arr[large_index] or { panic('out of bounds') }
```
